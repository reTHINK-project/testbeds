!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("activate",[],t):"object"==typeof exports?exports.activate=t():e.activate=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,r){(function(e){var n;!function(o){function i(e){throw new RangeError(E[e])}function a(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function s(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(A,"."),n+a(e.split("."),t).join(".")}function u(e){for(var t,r,n=[],o=0,i=e.length;i>o;)t=e.charCodeAt(o++),55296>t||t>56319||o>=i?n.push(t):(r=e.charCodeAt(o++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--));return n}function c(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=T(e>>>10&1023|55296),e=56320|1023&e),t+=T(e)}).join("")}function l(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:g}function f(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function d(e,t,r){var n=0;for(e=r?M(e/x):e>>1,e+=M(e/t);e>C*O>>1;n+=g)e=M(e/C);return M(n+(C+1)*e/(e+j))}function p(e){var t,r,n,o,a,s,u,f,p,h,v=[],y=e.length,m=0,_=R,j=k;for(r=e.lastIndexOf(P),0>r&&(r=0),n=0;r>n;++n)128>e.charCodeAt(n)||i("not-basic"),v.push(e.charCodeAt(n));for(o=r>0?r+1:0;y>o;){for(a=m,s=1,u=g;y>o||i("invalid-input"),f=l(e.charCodeAt(o++)),g>f&&f<=M((b-m)/s)||i("overflow"),m+=f*s,(p=u>j?j+O>u?u-j:O:w)<=f;u+=g)h=g-p,s>M(b/h)&&i("overflow"),s*=h;t=v.length+1,j=d(m-a,t,0==a),M(m/t)>b-_&&i("overflow"),_+=M(m/t),m%=t,v.splice(m++,0,_)}return c(v)}function h(e){var t,r,n,o,a,s,c,l,p,h,v,y,m,_,j,x=[];for(e=u(e),y=e.length,t=R,r=0,a=k,s=0;y>s;++s)128>(v=e[s])&&x.push(T(v));for(n=o=x.length,o&&x.push(P);y>n;){for(c=b,s=0;y>s;++s)(v=e[s])>=t&&c>v&&(c=v);for(m=n+1,c-t>M((b-r)/m)&&i("overflow"),r+=(c-t)*m,t=c,s=0;y>s;++s)if(v=e[s],t>v&&++r>b&&i("overflow"),v==t){for(l=r,p=g;(h=p>a?a+O>p?p-a:O:w)<=l;p+=g)j=l-h,_=g-h,x.push(T(f(h+j%_,0))),l=M(j/_);x.push(T(f(l,0))),a=d(r,m,n==o),r=0,++n}++r,++t}return x.join("")}function v(e){return s(e,function(e){return S.test(e)?p(e.slice(4).toLowerCase()):e})}function y(e){return s(e,function(e){return L.test(e)?"xn--"+h(e):e})}var m=Object({});var _,b=2147483647,g=36,w=1,O=26,j=38,x=700,k=72,R=128,P="-",S=/^xn--/,L=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=g-w,M=Math.floor,T=String.fromCharCode;_={version:"1.3.2",ucs2:{decode:u,encode:c},decode:p,encode:h,toASCII:y,toUnicode:v},void 0!==(n=function(){return _}.call(t,r,t,e))&&(e.exports=n)}()}).call(t,r(9)(e))},function(e,t,r){var n,o;!function(i,a){"use strict";"object"==typeof e&&e.exports?e.exports=a():(n=a,void 0!==(o="function"==typeof n?n.call(t,r,t,e):n)&&(e.exports=o))}(0,function(e){"use strict";function t(e){var t=e.toLowerCase(),r=t.split(":"),n=r.length,o=8;""===r[0]&&""===r[1]&&""===r[2]?(r.shift(),r.shift()):""===r[0]&&""===r[1]?r.shift():""===r[n-1]&&""===r[n-2]&&r.pop(),n=r.length,-1!==r[n-1].indexOf(".")&&(o=7);var i;for(i=0;n>i&&""!==r[i];i++);if(o>i)for(r.splice(i,1,"0000");o>r.length;)r.splice(i,0,"0000");for(var a,s=0;o>s;s++){a=r[s].split("");for(var u=0;3>u&&("0"===a[0]&&1<a.length);u++)a.splice(0,1);r[s]=a.join("")}var c=-1,l=0,f=0,d=-1,p=!1;for(s=0;o>s;s++)p?"0"===r[s]?f+=1:(p=!1,f>l&&(c=d,l=f)):"0"===r[s]&&(p=!0,d=s,f=1);f>l&&(c=d,l=f),l>1&&r.splice(c,l,""),n=r.length;var h="";for(""===r[0]&&(h=":"),s=0;n>s&&(h+=r[s],s!==n-1);s++)h+=":";return""===r[n-1]&&(h+=":"),h}function r(){return e.IPv6===this&&(e.IPv6=n),this}var n=e&&e.IPv6;return{best:t,noConflict:r}})},function(e,t,r){var n,o;!function(i,a){"use strict";"object"==typeof e&&e.exports?e.exports=a():(n=a,void 0!==(o="function"==typeof n?n.call(t,r,t,e):n)&&(e.exports=o))}(0,function(e){"use strict";var t=e&&e.SecondLevelDomains,r={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(0>=t||t>=e.length-1)return!1;var n=e.lastIndexOf(".",t-1);if(0>=n||n>=t-1)return!1;var o=r.list[e.slice(t+1)];return!!o&&o.indexOf(" "+e.slice(n+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(0>=t||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var n=r.list[e.slice(t+1)];return!!n&&n.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(0>=t||t>=e.length-1)return null;var n=e.lastIndexOf(".",t-1);if(0>=n||n>=t-1)return null;var o=r.list[e.slice(t+1)];return o?0>o.indexOf(" "+e.slice(n+1,t)+" ")?null:e.slice(n+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return r})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,r){return{name:"UserAvailabilityReporter",instance:new _(e,t,r)}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.default=s;var c=r(4),l=n(c),f=r(5),d=r(6),p=n(d),h=r(7),v=r(8),y=(n(v),r(10)),m=n(y),_=function(e){function t(e,r,n){if(o(this,t),!e)throw Error("The hypertyURL is a needed parameter");if(!r)throw Error("The MiniBus is a needed parameter");if(!n)throw Error("The configuration is a needed parameter");var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return console.info("[UserAvailabilityReporter] started with url: ",e),a.syncher=new f.Syncher(e,r,n),a.identityManager=new l.default(e,n.runtimeURL,r),a.domain=(0,h.divideURL)(e).domain,a.userAvailabilityyDescURL="hyperty-catalogue://catalogue."+a.domain+"/.well-known/dataschema/Context",a.syncher.onNotification(function(e){a.onNotification(e)}),a.syncher.onClose(function(e){console.log("[UserAvailabilityReporter.onClose]"),a.setStatus("unavailable"),e.ack()}),a}return a(t,e),u(t,[{key:"start",value:function(){var e=this,t=this;return new Promise(function(r,n){e.syncher.resumeReporters({store:!0}).then(function(e){var n=Object.keys(e);n.length>0?(console.log("[UserAvailabilityReporter.start] resuming ",e[n[0]]),t.userAvailability=e[n[0]],t._onSubscription(t.userAvailability),r(t.userAvailability)):(console.log("[UserAvailabilityReporter.start] nothing to resume ",e),r(t._create()))}).catch(function(e){console.error("[UserAvailabilityReporter] Resume failed | ",e)})}).catch(function(e){reject("[UserAvailabilityReporter] Start failed | ",e)})}},{key:"onResumeReporter",value:function(e){this._onResumeReporter=e}},{key:"onNotification",value:function(e){console.info("userAvailability Event Received: ",e),console.log("from hyperty",e.from),e.ack()}},{key:"_create",value:function(){var e=this;return new Promise(function(t,r){console.info("[UserAvailabilityReporter.create] lets create a new User availability Context Object "),e.syncher.create(e.userAvailabilityyDescURL,[],(0,m.default)(),!0,!1,"myAvailability",null,{resources:["availability_context"],expires:30}).then(function(r){e.userAvailability=r,e._onSubscription(r),t(r)}).catch(function(e){r(e)})})}},{key:"_onSubscription",value:function(e){e.onSubscription(function(e){console.info("[UserAvailabilityReporterReporter._onSubscription] accepting: ",e),e.accept()})}},{key:"setStatus",value:function(e){var t=this;console.log("[UserAvailabilityReporterReporter.setStatus] before change :",t.userAvailability.data),t.userAvailability.data.values[0].value=e,console.debug("[UserAvailabilityReporterReporter.setStatus] after change :",t.userAvailability.data),t.trigger("my-availability-update",e)}}]),t}(p.default)},function(e,t,r){!function(t,r){e.exports=r()}(0,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=152)}([function(e,t){var r=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=r)},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(36)("wks"),o=r(21),i=r(1).Symbol,a="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=n},function(e,t,r){e.exports=!r(12)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(1),o=r(0),i=r(14),a=r(10),s=function(e,t,r){var u,c,l,f=e&s.F,d=e&s.G,p=e&s.S,h=e&s.P,v=e&s.B,y=e&s.W,m=d?o:o[t]||(o[t]={}),_=m.prototype,b=d?n:p?n[t]:(n[t]||{}).prototype;d&&(r=t);for(u in r)(c=!f&&b&&void 0!==b[u])&&u in m||(l=c?b[u]:r[u],m[u]=d&&"function"!=typeof b[u]?r[u]:v&&c?i(l,n):y&&b[u]==l?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):h&&"function"==typeof l?i(Function.call,l):l,h&&((m.virtual||(m.virtual={}))[u]=l,e&s.R&&_&&!_[u]&&a(_,u,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){var n=r(7),o=r(34),i=r(20),a=Object.defineProperty;t.f=r(3)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(8);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(43),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){var n=r(6),o=r(15);e.exports=r(3)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){var n=r(63),o=r(31);e.exports=function(e){return n(o(e))}},function(e,t,r){var n=r(17);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports={}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(8),o=r(1).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,r){var n=r(8);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(53),o=r(37);e.exports=Object.keys||function(e){return n(e,o)}},,function(e,t,r){var n=r(6).f,o=r(11),i=r(2)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},,function(e,t){e.exports=!0},,,function(e,t,r){e.exports={default:r(99),__esModule:!0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){function t(e){return e.replace(/([a-zA-Z-]*)(:\/\/(?:\.)?|:)([-a-zA-Z0-9@:%._\+~#=]{2,256})([-a-zA-Z0-9@:%._\+~#=\/]*)/gi,"$1,$3,$4").split(",")}var r=t(e);if(r[0]===e&&!r[0].includes("@")){var n={type:"",domain:e,identity:""};return console.warn("[DivideURL] DivideURL don't support url without scheme. Please review your url address",e),n}return r[0]===e&&r[0].includes("@")&&(r=t((r[0]===e?"smtp":r[0])+"://"+r[0])),r[1].includes("@")&&(r[2]=r[0]+"://"+r[1],r[1]=r[1].substr(r[1].indexOf("@")+1)),{type:r[0],domain:r[1],identity:r[2]}}function i(e){var t=e.indexOf("@");return{username:e.substring(0,t),domain:e.substring(t+1,e.length)}}function a(e){return!((0,y.default)(e).length>0)}function s(e){if(e)return JSON.parse((0,h.default)(e))}function u(e){var t=e.indexOf("@");return"user://"+e.substring(t+1,e.length)+"/"+e.substring(0,t)}function c(e){var t=o(e);return t.identity.replace("/","")+"@"+t.domain}function l(e){if("user://"===e.substring(0,7)){var t=o(e);if(t.domain&&t.identity)return e;throw"userURL with wrong format"}return u(e)}function f(e){var t=/((([a-zA-Z]+):\/\/([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})\/[a-zA-Z0-9\.]+@[a-zA-Z0-9]+(\-)?[a-zA-Z0-9]+(\.)?[a-zA-Z0-9]{2,10}?\.[a-zA-Z]{2,10})(.+(?=.identity))?/gm,r=[],n=[];if(null==e.match(t))n=e.split(".");else{for(var o=void 0;null!==(o=t.exec(e));)o.index===t.lastIndex&&t.lastIndex++,o.forEach(function(e,t){0===t&&r.push(e)});var i=void 0;r.forEach(function(t){i=e.replace(t,"*+*"),n=i.split(".").map(function(e){return"*+*"===e?t:e})})}return console.log("[ServiceFramework.Utils.checkAttribute]",n),n}function d(e){var t=/([0-9a-zA-Z][-\w]*):\/\//g;if(e.includes("://")){var r=e.split(t)[0],n=r.split("."),o=e.replace(r,"");if(e.includes("identity")){var i=o.split("identity.");console.log("array2 "+i),o=i[0].slice(".",-1),i=i[1].split("."),n.push(o,"identity"),n=n.concat(i)}else n.push(o);return n.filter(Boolean)}return e.split(".")}Object.defineProperty(t,"__esModule",{value:!0});var p=r(56),h=n(p),v=r(61),y=n(v);t.divideURL=o,t.divideEmail=i,t.emptyObject=a,t.deepClone=s,t.getUserURLFromEmail=u,t.getUserEmailFromURL=c,t.convertToUserURL=l,t.checkAttribute=f,t.parseAttributes=d},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(36)("keys"),o=r(21);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){e.exports=!r(3)&&!r(12)(function(){return 7!=Object.defineProperty(r(19)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(31);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(1),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(7),o=r(71),i=r(37),a=r(32)("IE_PROTO"),s=function(){},u=function(){var e,t=r(19)("iframe"),n=i.length;for(t.style.display="none",r(58).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u.prototype[i[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=u(),void 0===t?r:o(r,t)}},,,,function(e,t,r){var n=r(4),o=r(0),i=r(12);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",a)}},function(e,t,r){e.exports={default:r(44),__esModule:!0}},function(e,t,r){r(45);var n=r(0).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(4);n(n.S+n.F*!r(3),"Object",{defineProperty:r(6).f})},function(e,t,r){"use strict";var n=r(26),o=r(4),i=r(52),a=r(10),s=r(11),u=r(16),c=r(70),l=r(24),f=r(49),d=r(2)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,r,v,y,m,_){c(r,t,v);var b,g,w,O=function(e){if(!p&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},j=t+" Iterator",x="values"==y,k=!1,R=e.prototype,P=R[d]||R["@@iterator"]||y&&R[y],S=P||O(y),L=y?x?O("entries"):S:void 0,A="Array"==t?R.entries||P:P;if(A&&(w=f(A.call(new e)))!==Object.prototype&&w.next&&(l(w,j,!0),n||s(w,d)||a(w,d,h)),x&&P&&"values"!==P.name&&(k=!0,S=function(){return P.call(this)}),n&&!_||!p&&!k&&R[d]||a(R,d,S),u[t]=S,u[j]=h,y)if(b={values:x?S:O("values"),keys:m?S:O("keys"),entries:L},_)for(g in b)g in R||i(R,g,b[g]);else o(o.P+o.F*(p||k),t,b);return b}},,function(e,t,r){"use strict";function n(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=o(t),this.reject=o(r)}var o=r(17);e.exports.f=function(e){return new n(e)}},function(e,t,r){var n=r(11),o=r(35),i=r(32)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},,function(e,t,r){"use strict";var n=r(69)(!0);r(46)(String,"String",function(e){this._t=e+"",this._i=0},function(){var e,t=this._t,r=this._i;return t.length>r?(e=n(t,r),this._i+=e.length,{value:e,done:!1}):{value:void 0,done:!0}})},function(e,t,r){e.exports=r(10)},function(e,t,r){var n=r(11),o=r(13),i=r(72)(!1),a=r(32)("IE_PROTO");e.exports=function(e,t){var r,s=o(e),u=0,c=[];for(r in s)r!=a&&n(s,r)&&c.push(r);for(;t.length>u;)n(s,r=t[u++])&&(~i(c,r)||c.push(r));return c}},function(e,t,r){r(74);for(var n=r(1),o=r(10),i=r(16),a=r(2)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;s.length>u;u++){var c=s[u],l=n[c],f=l&&l.prototype;f&&!f[a]&&o(f,a,c),i[c]=i.Array}},,function(e,t,r){e.exports={default:r(64),__esModule:!0}},function(e,t,r){var n=r(33),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){var n=r(1).document;e.exports=n&&n.documentElement},,function(e,t){},function(e,t,r){e.exports={default:r(112),__esModule:!0}},function(e,t,r){var n=r(18),o=r(2)("toStringTag"),i="Arguments"==n(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=a(t=Object(e),o))?r:i?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){var n=r(18);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(0),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t,r){var n=r(7),o=r(17),i=r(2)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[i])?t:o(r)}},function(e,t,r){var n,o,i,a=r(14),s=r(105),u=r(58),c=r(19),l=r(1),f=l.process,d=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,v=l.Dispatch,y=0,m={},_=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){_.call(e.data)};d&&p||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++y]=function(){s("function"==typeof e?e:Function(e),t)},n(y),y},p=function(e){delete m[e]},"process"==r(18)(f)?n=function(e){f.nextTick(a(_,e,1))}:v&&v.now?n=function(e){v.now(a(_,e,1))}:h?(o=new h,i=o.port2,o.port1.onmessage=b,n=a(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),_.call(e)}}:function(e){setTimeout(a(_,e,1),0)}),e.exports={set:d,clear:p}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(7),o=r(8),i=r(48);e.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){var n=r(33),o=r(31);e.exports=function(e){return function(t,r){var i,a,s=o(t)+"",u=n(r),c=s.length;return 0>u||u>=c?e?"":void 0:(i=s.charCodeAt(u),55296>i||i>56319||u+1===c||56320>(a=s.charCodeAt(u+1))||a>57343?e?s.charAt(u):i:e?s.slice(u,u+2):a-56320+(i-55296<<10)+65536)}}},function(e,t,r){"use strict";var n=r(38),o=r(15),i=r(24),a={};r(10)(a,r(2)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:o(1,r)}),i(e,t+" Iterator")}},function(e,t,r){var n=r(6),o=r(7),i=r(22);e.exports=r(3)?Object.defineProperties:function(e,t){o(e);for(var r,a=i(t),s=a.length,u=0;s>u;)n.f(e,r=a[u++],t[r]);return e}},function(e,t,r){var n=r(13),o=r(57),i=r(73);e.exports=function(e){return function(t,r,a){var s,u=n(t),c=o(u.length),l=i(a,c);if(e&&r!=r){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(33),o=Math.max,i=Math.min;e.exports=function(e,t){return e=n(e),0>e?o(e+t,0):i(e,t)}},function(e,t,r){"use strict";var n=r(75),o=r(76),i=r(16),a=r(13);e.exports=r(46)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return e&&e.length>r?"keys"==t?o(0,r):"values"==t?o(0,e[r]):o(0,[r,e[r]]):(this._t=void 0,o(1))},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},,,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(62),o=r(2)("iterator"),i=r(16);e.exports=r(0).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){r(60),r(51),r(54),r(100),r(110),r(111),e.exports=r(0).Promise},function(e,t,r){"use strict";var n,o,i,a,s=r(26),u=r(1),c=r(14),l=r(62),f=r(4),d=r(8),p=r(17),h=r(101),v=r(102),y=r(65),m=r(66).set,_=r(106)(),b=r(48),g=r(67),w=r(68),O=u.TypeError,j=u.process,x=u.Promise,k="process"==l(j),R=function(){},P=o=b.f,S=!!function(){try{var e=x.resolve(1),t=(e.constructor={})[r(2)("species")]=function(e){e(R,R)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(R)instanceof t}catch(e){}}(),L=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},A=function(e,t){if(!e._n){e._n=!0;var r=e._c;_(function(){for(var n=e._v,o=1==e._s,i=0;r.length>i;)!function(t){var r,i,a=o?t.ok:t.fail,s=t.resolve,u=t.reject,c=t.domain;try{a?(o||(2==e._h&&M(e),e._h=1),!0===a?r=n:(c&&c.enter(),r=a(n),c&&c.exit()),r===t.promise?u(O("Promise-chain cycle")):(i=L(r))?i.call(r,s,u):s(r)):u(n)}catch(e){u(e)}}(r[i++]);e._c=[],e._n=!1,t&&!e._h&&E(e)})}},E=function(e){m.call(u,function(){var t,r,n,o=e._v,i=C(e);if(i&&(t=g(function(){k?j.emit("unhandledRejection",o,e):(r=u.onunhandledrejection)?r({promise:e,reason:o}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",o)}),e._h=k||C(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},C=function(e){if(1==e._h)return!1;for(var t,r=e._a||e._c,n=0;r.length>n;)if(t=r[n++],t.fail||!C(t.promise))return!1;return!0},M=function(e){m.call(u,function(){var t;k?j.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},T=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),A(t,!0))},U=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw O("Promise can't be resolved itself");(t=L(e))?_(function(){var n={_w:r,_d:!1};try{t.call(e,c(U,n,1),c(T,n,1))}catch(e){T.call(n,e)}}):(r._v=e,r._s=1,A(r,!1))}catch(e){T.call({_w:r,_d:!1},e)}}};S||(x=function(e){h(this,x,"Promise","_h"),p(e),n.call(this);try{e(c(U,this,1),c(T,this,1))}catch(e){T.call(this,e)}},n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r(107)(x.prototype,{then:function(e,t){var r=P(y(this,x));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=k?j.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n;this.promise=e,this.resolve=c(U,e,1),this.reject=c(T,e,1)},b.f=P=function(e){return e===x||e===a?new i(e):o(e)}),f(f.G+f.W+f.F*!S,{Promise:x}),r(24)(x,"Promise"),r(108)("Promise"),a=r(0).Promise,f(f.S+f.F*!S,"Promise",{reject:function(e){var t=P(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!S),"Promise",{resolve:function(e){return w(s&&this===a?x:this,e)}}),f(f.S+f.F*!(S&&r(109)(function(e){x.all(e).catch(R)})),"Promise",{all:function(e){var t=this,r=P(t),n=r.resolve,o=r.reject,i=g(function(){var r=[],i=0,a=1;v(e,!1,function(e){var s=i++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},o)}),--a||n(r)});return i.e&&o(i.v),r.promise},race:function(e){var t=this,r=P(t),n=r.reject,o=g(function(){v(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}})},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(14),o=r(103),i=r(104),a=r(7),s=r(57),u=r(98),c={},l={},t=e.exports=function(e,t,r,f,d){var p,h,v,y,m=d?function(){return e}:u(e),_=n(r,f,t?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(i(m)){for(p=s(e.length);p>b;b++)if((y=t?_(a(h=e[b])[0],h[1]):_(e[b]))===c||y===l)return y}else for(v=m.call(e);!(h=v.next()).done;)if((y=o(v,_,h.value,t))===c||y===l)return y};t.BREAK=c,t.RETURN=l},function(e,t,r){var n=r(7);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},function(e,t,r){var n=r(16),o=r(2)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(1),o=r(66).set,i=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,u="process"==r(18)(a);e.exports=function(){var e,t,r,c=function(){var n,o;for(u&&(n=a.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(u)r=function(){a.nextTick(c)};else if(i){var l=!0,f=document.createTextNode("");new i(c).observe(f,{characterData:!0}),r=function(){f.data=l=!l}}else if(s&&s.resolve){var d=s.resolve();r=function(){d.then(c)}}else r=function(){o.call(n,c)};return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}}},function(e,t,r){var n=r(10);e.exports=function(e,t,r){for(var o in t)r&&e[o]?e[o]=t[o]:n(e,o,t[o]);return e}},function(e,t,r){"use strict";var n=r(1),o=r(0),i=r(6),a=r(3),s=r(2)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:n[e];a&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(2)("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],a=i[n]();a.next=function(){return{done:r=!0}},i[n]=function(){return a},e(i)}catch(e){}return r}},function(e,t,r){"use strict";var n=r(4),o=r(0),i=r(1),a=r(65),s=r(68);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,o.Promise||i.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){"use strict";var n=r(4),o=r(48),i=r(67);n(n.S,"Promise",{try:function(e){var t=o.f(this),r=i(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){r(113),e.exports=r(0).Object.keys},function(e,t,r){var n=r(35),o=r(22);r(42)("keys",function(){return function(e){return o(n(e))}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(153);t.default=function(e){return e&&e.__esModule?e:{default:e}}(n).default,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),i=n(o),a=r(5),s=n(a),u=r(9),c=n(u),l=r(30);t.default=function(){function e(t,r,n){(0,s.default)(this,e);var o=this;o.messageBus=n,o.domain=(0,l.divideURL)(t).domain,o.hypertyURL=t,o.runtimeURL=r}return(0,c.default)(e,[{key:"discoverUserRegistered",value:function(e,t){var r=this,n=void 0,o=e||".";n=t||r.hypertyURL;var a={type:"read",from:n,to:r.runtimeURL+"/registry/",body:{resource:o,criteria:n}};return new i.default(function(e,t){r.messageBus.postMessage(a,function(r){var n=r.body.resource;n&&200===r.body.code?e(n):t("code: "+r.body.code+" No user was found")})})}}]),e}(),e.exports=t.default}])})},function(e,t,r){!function(t,r){e.exports=r()}(0,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=180)}([function(e,t){var r=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=r)},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(36)("wks"),o=r(21),i=r(1).Symbol,a="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=n},function(e,t,r){e.exports=!r(12)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(1),o=r(0),i=r(14),a=r(10),s=function(e,t,r){var u,c,l,f=e&s.F,d=e&s.G,p=e&s.S,h=e&s.P,v=e&s.B,y=e&s.W,m=d?o:o[t]||(o[t]={}),_=m.prototype,b=d?n:p?n[t]:(n[t]||{}).prototype;d&&(r=t);for(u in r)(c=!f&&b&&void 0!==b[u])&&u in m||(l=c?b[u]:r[u],m[u]=d&&"function"!=typeof b[u]?r[u]:v&&c?i(l,n):y&&b[u]==l?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):h&&"function"==typeof l?i(Function.call,l):l,h&&((m.virtual||(m.virtual={}))[u]=l,e&s.R&&_&&!_[u]&&a(_,u,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){var n=r(7),o=r(34),i=r(20),a=Object.defineProperty;t.f=r(3)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(8);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(43),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){var n=r(6),o=r(15);e.exports=r(3)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){var n=r(63),o=r(31);e.exports=function(e){return n(o(e))}},function(e,t,r){var n=r(17);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports={}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(8),o=r(1).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,r){var n=r(8);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(53),o=r(37);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t,r){e.exports={default:r(79),__esModule:!0}},function(e,t,r){var n=r(6).f,o=r(11),i=r(2)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,r){var n,o;!function(i,a){"use strict";n=a,void 0!==(o="function"==typeof n?n.call(t,r,t,e):n)&&(e.exports=o)}(0,function(){"use strict";function e(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function t(t){return"debug"===t&&(t="log"),typeof console!==s&&(void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):a)}function r(e,t){for(var r=0;u.length>r;r++){var n=u[r];this[n]=e>r?a:this.methodFactory(n,e,t)}this.log=this.debug}function n(e,t,n){return function(){typeof console!==s&&(r.call(this,t,n),this[e].apply(this,arguments))}}function o(e,r,o){return t(e)||n.apply(this,arguments)}function i(e,t,n){function i(e){var t=(u[e]||"silent").toUpperCase();if(typeof window!==s){try{return void(window.localStorage[f]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(e){}}}function a(){var e;if(typeof window!==s){try{e=window.localStorage[f]}catch(e){}if(typeof e===s)try{var t=window.document.cookie,r=t.indexOf(encodeURIComponent(f)+"=");-1!==r&&(e=/^([^;]+)/.exec(t.slice(r))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}}var c,l=this,f="loglevel";e&&(f+=":"+e),l.name=e,l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=n||o,l.getLevel=function(){return c},l.setLevel=function(t,n){if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&l.levels.SILENT>=t))throw"log.setLevel() called with invalid level: "+t;if(c=t,!1!==n&&i(t),r.call(l,t,e),typeof console===s&&l.levels.SILENT>t)return"No console available for logging"},l.setDefaultLevel=function(e){a()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var d=a();null==d&&(d=null==t?"WARN":t),l.setLevel(d,!1)}var a=function(){},s="undefined",u=["trace","debug","info","warn","error"],c=new i,l={};c.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new i(e,c.getLevel(),c.methodFactory)),t};var f=typeof window!==s?window.log:void 0;return c.noConflict=function(){return typeof window!==s&&window.log===c&&(window.log=f),c},c.getLoggers=function(){return l},c})},function(e,t){e.exports=!0},function(e,t,r){"use strict";t.__esModule=!0;var n=r(50),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,o.default)(t))&&"function"!=typeof t?e:t}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(91),i=n(o),a=r(95),s=n(a),u=r(50),c=n(u);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,c.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}},function(e,t,r){e.exports={default:r(99),__esModule:!0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){function t(e){return e.replace(/([a-zA-Z-]*)(:\/\/(?:\.)?|:)([-a-zA-Z0-9@:%._\+~#=]{2,256})([-a-zA-Z0-9@:%._\+~#=\/]*)/gi,"$1,$3,$4").split(",")}var r=t(e);if(r[0]===e&&!r[0].includes("@")){var n={type:"",domain:e,identity:""};return console.warn("[DivideURL] DivideURL don't support url without scheme. Please review your url address",e),n}return r[0]===e&&r[0].includes("@")&&(r=t((r[0]===e?"smtp":r[0])+"://"+r[0])),r[1].includes("@")&&(r[2]=r[0]+"://"+r[1],r[1]=r[1].substr(r[1].indexOf("@")+1)),{type:r[0],domain:r[1],identity:r[2]}}function i(e){var t=e.indexOf("@");return{username:e.substring(0,t),domain:e.substring(t+1,e.length)}}function a(e){return!((0,y.default)(e).length>0)}function s(e){if(e)return JSON.parse((0,h.default)(e))}function u(e){var t=e.indexOf("@");return"user://"+e.substring(t+1,e.length)+"/"+e.substring(0,t)}function c(e){var t=o(e);return t.identity.replace("/","")+"@"+t.domain}function l(e){if("user://"===e.substring(0,7)){var t=o(e);if(t.domain&&t.identity)return e;throw"userURL with wrong format"}return u(e)}function f(e){var t=/((([a-zA-Z]+):\/\/([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})\/[a-zA-Z0-9\.]+@[a-zA-Z0-9]+(\-)?[a-zA-Z0-9]+(\.)?[a-zA-Z0-9]{2,10}?\.[a-zA-Z]{2,10})(.+(?=.identity))?/gm,r=[],n=[];if(null==e.match(t))n=e.split(".");else{for(var o=void 0;null!==(o=t.exec(e));)o.index===t.lastIndex&&t.lastIndex++,o.forEach(function(e,t){0===t&&r.push(e)});var i=void 0;r.forEach(function(t){i=e.replace(t,"*+*"),n=i.split(".").map(function(e){return"*+*"===e?t:e})})}return console.log("[ServiceFramework.Utils.checkAttribute]",n),n}function d(e){var t=/([0-9a-zA-Z][-\w]*):\/\//g;if(e.includes("://")){var r=e.split(t)[0],n=r.split("."),o=e.replace(r,"");if(e.includes("identity")){var i=o.split("identity.");console.log("array2 "+i),o=i[0].slice(".",-1),i=i[1].split("."),n.push(o,"identity"),n=n.concat(i)}else n.push(o);return n.filter(Boolean)}return e.split(".")}Object.defineProperty(t,"__esModule",{value:!0});var p=r(56),h=n(p),v=r(61),y=n(v);t.divideURL=o,t.divideEmail=i,t.emptyObject=a,t.deepClone=s,t.getUserURLFromEmail=u,t.getUserEmailFromURL=c,t.convertToUserURL=l,t.checkAttribute=f,t.parseAttributes=d},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(36)("keys"),o=r(21);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){e.exports=!r(3)&&!r(12)(function(){return 7!=Object.defineProperty(r(19)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(31);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(1),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(7),o=r(71),i=r(37),a=r(32)("IE_PROTO"),s=function(){},u=function(){var e,t=r(19)("iframe"),n=i.length;for(t.style.display="none",r(58).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u.prototype[i[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=u(),void 0===t?r:o(r,t)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){t.f=r(2)},function(e,t,r){var n=r(1),o=r(0),i=r(26),a=r(40),s=r(6).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,r){var n=r(4),o=r(0),i=r(12);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",a)}},function(e,t,r){e.exports={default:r(44),__esModule:!0}},function(e,t,r){r(45);var n=r(0).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(4);n(n.S+n.F*!r(3),"Object",{defineProperty:r(6).f})},function(e,t,r){"use strict";var n=r(26),o=r(4),i=r(52),a=r(10),s=r(11),u=r(16),c=r(70),l=r(24),f=r(49),d=r(2)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,r,v,y,m,_){c(r,t,v);var b,g,w,O=function(e){if(!p&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},j=t+" Iterator",x="values"==y,k=!1,R=e.prototype,P=R[d]||R["@@iterator"]||y&&R[y],S=P||O(y),L=y?x?O("entries"):S:void 0,A="Array"==t?R.entries||P:P;if(A&&(w=f(A.call(new e)))!==Object.prototype&&w.next&&(l(w,j,!0),n||s(w,d)||a(w,d,h)),x&&P&&"values"!==P.name&&(k=!0,S=function(){return P.call(this)}),n&&!_||!p&&!k&&R[d]||a(R,d,S),u[t]=S,u[j]=h,y)if(b={values:x?S:O("values"),keys:m?S:O("keys"),entries:L},_)for(g in b)g in R||i(R,g,b[g]);else o(o.P+o.F*(p||k),t,b);return b}},function(e,t,r){var n=r(39),o=r(15),i=r(13),a=r(20),s=r(11),u=r(34),c=Object.getOwnPropertyDescriptor;t.f=r(3)?c:function(e,t){if(e=i(e),t=a(t,!0),u)try{return c(e,t)}catch(e){}if(s(e,t))return o(!n.f.call(e,t),e[t])}},function(e,t,r){"use strict";function n(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=o(t),this.reject=o(r)}var o=r(17);e.exports.f=function(e){return new n(e)}},function(e,t,r){var n=r(11),o=r(35),i=r(32)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(81),i=n(o),a=r(83),s=n(a),u="function"==typeof s.default&&"symbol"==typeof i.default?function(e){return typeof e}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};t.default="function"==typeof s.default&&"symbol"===u(i.default)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":void 0===e?"undefined":u(e)}},function(e,t,r){"use strict";var n=r(69)(!0);r(46)(String,"String",function(e){this._t=e+"",this._i=0},function(){var e,t=this._t,r=this._i;return t.length>r?(e=n(t,r),this._i+=e.length,{value:e,done:!1}):{value:void 0,done:!0}})},function(e,t,r){e.exports=r(10)},function(e,t,r){var n=r(11),o=r(13),i=r(72)(!1),a=r(32)("IE_PROTO");e.exports=function(e,t){var r,s=o(e),u=0,c=[];for(r in s)r!=a&&n(s,r)&&c.push(r);for(;t.length>u;)n(s,r=t[u++])&&(~i(c,r)||c.push(r));return c}},function(e,t,r){r(74);for(var n=r(1),o=r(10),i=r(16),a=r(2)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;s.length>u;u++){var c=s[u],l=n[c],f=l&&l.prototype;f&&!f[a]&&o(f,a,c),i[c]=i.Array}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){e.exports={default:r(64),__esModule:!0}},function(e,t,r){var n=r(33),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){var n=r(1).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(53),o=r(37).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},function(e,t){},function(e,t,r){e.exports={default:r(112),__esModule:!0}},function(e,t,r){var n=r(18),o=r(2)("toStringTag"),i="Arguments"==n(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=a(t=Object(e),o))?r:i?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){var n=r(18);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(0),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t,r){var n=r(7),o=r(17),i=r(2)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[i])?t:o(r)}},function(e,t,r){var n,o,i,a=r(14),s=r(105),u=r(58),c=r(19),l=r(1),f=l.process,d=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,v=l.Dispatch,y=0,m={},_=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){_.call(e.data)};d&&p||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++y]=function(){s("function"==typeof e?e:Function(e),t)},n(y),y},p=function(e){delete m[e]},"process"==r(18)(f)?n=function(e){f.nextTick(a(_,e,1))}:v&&v.now?n=function(e){v.now(a(_,e,1))}:h?(o=new h,i=o.port2,o.port1.onmessage=b,n=a(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),_.call(e)}}:function(e){setTimeout(a(_,e,1),0)}),e.exports={set:d,clear:p}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(7),o=r(8),i=r(48);e.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){var n=r(33),o=r(31);e.exports=function(e){return function(t,r){var i,a,s=o(t)+"",u=n(r),c=s.length;return 0>u||u>=c?e?"":void 0:(i=s.charCodeAt(u),55296>i||i>56319||u+1===c||56320>(a=s.charCodeAt(u+1))||a>57343?e?s.charAt(u):i:e?s.slice(u,u+2):a-56320+(i-55296<<10)+65536)}}},function(e,t,r){"use strict";var n=r(38),o=r(15),i=r(24),a={};r(10)(a,r(2)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:o(1,r)}),i(e,t+" Iterator")}},function(e,t,r){var n=r(6),o=r(7),i=r(22);e.exports=r(3)?Object.defineProperties:function(e,t){o(e);for(var r,a=i(t),s=a.length,u=0;s>u;)n.f(e,r=a[u++],t[r]);return e}},function(e,t,r){var n=r(13),o=r(57),i=r(73);e.exports=function(e){return function(t,r,a){var s,u=n(t),c=o(u.length),l=i(a,c);if(e&&r!=r){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(33),o=Math.max,i=Math.min;e.exports=function(e,t){return e=n(e),0>e?o(e+t,0):i(e,t)}},function(e,t,r){"use strict";var n=r(75),o=r(76),i=r(16),a=r(13);e.exports=r(46)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return e&&e.length>r?"keys"==t?o(0,r):"values"==t?o(0,e[r]):o(0,[r,e[r]]):(this._t=void 0,o(1))},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){var n=r(21)("meta"),o=r(8),i=r(11),a=r(6).f,s=0,u=Object.isExtensible||function(){return!0},c=!r(12)(function(){return u(Object.preventExtensions({}))}),l=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},f=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,n)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[n].i},d=function(e,t){if(!i(e,n)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[n].w},p=function(e){return c&&h.NEED&&u(e)&&!i(e,n)&&l(e),e},h=e.exports={KEY:n,NEED:!1,fastKey:f,getWeak:d,onFreeze:p}},,function(e,t,r){r(80),e.exports=r(0).Object.getPrototypeOf},function(e,t,r){var n=r(35),o=r(49);r(42)("getPrototypeOf",function(){return function(e){return o(n(e))}})},function(e,t,r){e.exports={default:r(82),__esModule:!0}},function(e,t,r){r(51),r(54),e.exports=r(40).f("iterator")},function(e,t,r){e.exports={default:r(84),__esModule:!0}},function(e,t,r){r(85),r(60),r(89),r(90),e.exports=r(0).Symbol},function(e,t,r){"use strict";var n=r(1),o=r(11),i=r(3),a=r(4),s=r(52),u=r(77).KEY,c=r(12),l=r(36),f=r(24),d=r(21),p=r(2),h=r(40),v=r(41),y=r(86),m=r(87),_=r(7),b=r(13),g=r(20),w=r(15),O=r(38),j=r(88),x=r(47),k=r(6),R=r(22),P=x.f,S=k.f,L=j.f,A=n.Symbol,E=n.JSON,C=E&&E.stringify,M=p("_hidden"),T=p("toPrimitive"),U={}.propertyIsEnumerable,I=l("symbol-registry"),z=l("symbols"),D=l("op-symbols"),F=Object.prototype,H="function"==typeof A,N=n.QObject,Q=!N||!N.prototype||!N.prototype.findChild,q=i&&c(function(){return 7!=O(S({},"a",{get:function(){return S(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=P(F,t);n&&delete F[t],S(e,t,r),n&&e!==F&&S(F,t,n)}:S,B=function(e){var t=z[e]=O(A.prototype);return t._k=e,t},V=H&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},Z=function(e,t,r){return e===F&&Z(D,t,r),_(e),t=g(t,!0),_(r),o(z,t)?(r.enumerable?(o(e,M)&&e[M][t]&&(e[M][t]=!1),r=O(r,{enumerable:w(0,!1)})):(o(e,M)||S(e,M,w(1,{})),e[M][t]=!0),q(e,t,r)):S(e,t,r)},$=function(e,t){_(e);for(var r,n=y(t=b(t)),o=0,i=n.length;i>o;)Z(e,r=n[o++],t[r]);return e},G=function(e,t){return void 0===t?O(e):$(O(e),t)},J=function(e){var t=U.call(this,e=g(e,!0));return!(this===F&&o(z,e)&&!o(D,e))&&(!(t||!o(this,e)||!o(z,e)||o(this,M)&&this[M][e])||t)},W=function(e,t){if(e=b(e),t=g(t,!0),e!==F||!o(z,t)||o(D,t)){var r=P(e,t);return!r||!o(z,t)||o(e,M)&&e[M][t]||(r.enumerable=!0),r}},Y=function(e){for(var t,r=L(b(e)),n=[],i=0;r.length>i;)o(z,t=r[i++])||t==M||t==u||n.push(t);return n},K=function(e){for(var t,r=e===F,n=L(r?D:b(e)),i=[],a=0;n.length>a;)!o(z,t=n[a++])||r&&!o(F,t)||i.push(z[t]);return i};H||(A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===F&&t.call(D,r),o(this,M)&&o(this[M],e)&&(this[M][e]=!1),q(this,e,w(1,r))};return i&&Q&&q(F,e,{configurable:!0,set:t}),B(e)},s(A.prototype,"toString",function(){return this._k}),x.f=W,k.f=Z,r(59).f=j.f=Y,r(39).f=J,r(55).f=K,i&&!r(26)&&s(F,"propertyIsEnumerable",J,!0),h.f=function(e){return B(p(e))}),a(a.G+a.W+a.F*!H,{Symbol:A});for(var X="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;X.length>ee;)p(X[ee++]);for(var te=R(p.store),re=0;te.length>re;)v(te[re++]);a(a.S+a.F*!H,"Symbol",{for:function(e){return o(I,e+="")?I[e]:I[e]=A(e)},keyFor:function(e){if(!V(e))throw TypeError(e+" is not a symbol!");for(var t in I)if(I[t]===e)return t},useSetter:function(){Q=!0},useSimple:function(){Q=!1}}),a(a.S+a.F*!H,"Object",{create:G,defineProperty:Z,defineProperties:$,getOwnPropertyDescriptor:W,getOwnPropertyNames:Y,getOwnPropertySymbols:K}),E&&a(a.S+a.F*(!H||c(function(){var e=A();return"[null]"!=C([e])||"{}"!=C({a:e})||"{}"!=C(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!V(e)){for(var t,r,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);return t=n[1],"function"==typeof t&&(r=t),!r&&m(t)||(t=function(e,t){if(r&&(t=r.call(this,e,t)),!V(t))return t}),n[1]=t,C.apply(E,n)}}}),A.prototype[T]||r(10)(A.prototype,T,A.prototype.valueOf),f(A,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},function(e,t,r){var n=r(22),o=r(55),i=r(39);e.exports=function(e){var t=n(e),r=o.f;if(r)for(var a,s=r(e),u=i.f,c=0;s.length>c;)u.call(e,a=s[c++])&&t.push(a);return t}},function(e,t,r){var n=r(18);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){var n=r(13),o=r(59).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(e){return a.slice()}};e.exports.f=function(e){return a&&"[object Window]"==i.call(e)?s(e):o(n(e))}},function(e,t,r){r(41)("asyncIterator")},function(e,t,r){r(41)("observable")},function(e,t,r){e.exports={default:r(92),__esModule:!0}},function(e,t,r){r(93),e.exports=r(0).Object.setPrototypeOf},function(e,t,r){var n=r(4);n(n.S,"Object",{setPrototypeOf:r(94).set})},function(e,t,r){var n=r(8),o=r(7),i=function(e,t){if(o(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{n=r(14)(Function.call,r(47).f(Object.prototype,"__proto__").set,2),n(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return i(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:i}},function(e,t,r){e.exports={default:r(96),__esModule:!0}},function(e,t,r){r(97);var n=r(0).Object;e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){var n=r(4);n(n.S,"Object",{create:r(38)})},function(e,t,r){var n=r(62),o=r(2)("iterator"),i=r(16);e.exports=r(0).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){r(60),r(51),r(54),r(100),r(110),r(111),e.exports=r(0).Promise},function(e,t,r){"use strict";var n,o,i,a,s=r(26),u=r(1),c=r(14),l=r(62),f=r(4),d=r(8),p=r(17),h=r(101),v=r(102),y=r(65),m=r(66).set,_=r(106)(),b=r(48),g=r(67),w=r(68),O=u.TypeError,j=u.process,x=u.Promise,k="process"==l(j),R=function(){},P=o=b.f,S=!!function(){try{var e=x.resolve(1),t=(e.constructor={})[r(2)("species")]=function(e){e(R,R)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(R)instanceof t}catch(e){}}(),L=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},A=function(e,t){if(!e._n){e._n=!0;var r=e._c;_(function(){for(var n=e._v,o=1==e._s,i=0;r.length>i;)!function(t){var r,i,a=o?t.ok:t.fail,s=t.resolve,u=t.reject,c=t.domain;try{a?(o||(2==e._h&&M(e),e._h=1),!0===a?r=n:(c&&c.enter(),r=a(n),c&&c.exit()),r===t.promise?u(O("Promise-chain cycle")):(i=L(r))?i.call(r,s,u):s(r)):u(n)}catch(e){u(e)}}(r[i++]);e._c=[],e._n=!1,t&&!e._h&&E(e)})}},E=function(e){m.call(u,function(){var t,r,n,o=e._v,i=C(e);if(i&&(t=g(function(){k?j.emit("unhandledRejection",o,e):(r=u.onunhandledrejection)?r({promise:e,reason:o}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",o)}),e._h=k||C(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},C=function(e){if(1==e._h)return!1;for(var t,r=e._a||e._c,n=0;r.length>n;)if(t=r[n++],t.fail||!C(t.promise))return!1;return!0},M=function(e){m.call(u,function(){var t;k?j.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},T=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),A(t,!0))},U=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw O("Promise can't be resolved itself");(t=L(e))?_(function(){var n={_w:r,_d:!1};try{t.call(e,c(U,n,1),c(T,n,1))}catch(e){T.call(n,e)}}):(r._v=e,r._s=1,A(r,!1))}catch(e){T.call({_w:r,_d:!1},e)}}};S||(x=function(e){h(this,x,"Promise","_h"),p(e),n.call(this);try{e(c(U,this,1),c(T,this,1))}catch(e){T.call(this,e)}},n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r(107)(x.prototype,{then:function(e,t){var r=P(y(this,x));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=k?j.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n;this.promise=e,this.resolve=c(U,e,1),this.reject=c(T,e,1)},b.f=P=function(e){return e===x||e===a?new i(e):o(e)}),f(f.G+f.W+f.F*!S,{Promise:x}),r(24)(x,"Promise"),r(108)("Promise"),a=r(0).Promise,f(f.S+f.F*!S,"Promise",{reject:function(e){var t=P(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!S),"Promise",{resolve:function(e){return w(s&&this===a?x:this,e)}}),f(f.S+f.F*!(S&&r(109)(function(e){x.all(e).catch(R)})),"Promise",{all:function(e){var t=this,r=P(t),n=r.resolve,o=r.reject,i=g(function(){var r=[],i=0,a=1;v(e,!1,function(e){var s=i++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},o)}),--a||n(r)});return i.e&&o(i.v),r.promise},race:function(e){var t=this,r=P(t),n=r.reject,o=g(function(){v(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}})},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(14),o=r(103),i=r(104),a=r(7),s=r(57),u=r(98),c={},l={},t=e.exports=function(e,t,r,f,d){var p,h,v,y,m=d?function(){return e}:u(e),_=n(r,f,t?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(i(m)){for(p=s(e.length);p>b;b++)if((y=t?_(a(h=e[b])[0],h[1]):_(e[b]))===c||y===l)return y}else for(v=m.call(e);!(h=v.next()).done;)if((y=o(v,_,h.value,t))===c||y===l)return y};t.BREAK=c,t.RETURN=l},function(e,t,r){var n=r(7);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},function(e,t,r){var n=r(16),o=r(2)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(1),o=r(66).set,i=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,u="process"==r(18)(a);e.exports=function(){var e,t,r,c=function(){var n,o;for(u&&(n=a.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(u)r=function(){a.nextTick(c)};else if(i){var l=!0,f=document.createTextNode("");new i(c).observe(f,{characterData:!0}),r=function(){f.data=l=!l}}else if(s&&s.resolve){var d=s.resolve();r=function(){d.then(c)}}else r=function(){o.call(n,c)};return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}}},function(e,t,r){var n=r(10);e.exports=function(e,t,r){for(var o in t)r&&e[o]?e[o]=t[o]:n(e,o,t[o]);return e}},function(e,t,r){"use strict";var n=r(1),o=r(0),i=r(6),a=r(3),s=r(2)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:n[e];a&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(2)("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],a=i[n]();a.next=function(){return{done:r=!0}},i[n]=function(){return a},e(i)}catch(e){}return r}},function(e,t,r){"use strict";var n=r(4),o=r(0),i=r(1),a=r(65),s=r(68);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,o.Promise||i.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){"use strict";var n=r(4),o=r(48),i=r(67);n(n.S,"Promise",{try:function(e){var t=o.f(this),r=i(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){r(113),e.exports=r(0).Object.keys},function(e,t,r){var n=r(35),o=r(22);r(42)("keys",function(){return function(e){return o(n(e))}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(23),i=n(o),a=r(122),s=n(a);t.default=function e(t,r,n){null===t&&(t=Function.prototype);var o=(0,s.default)(t,r);if(void 0===o){var a=(0,i.default)(t);return null===a?void 0:e(a,r,n)}if("value"in o)return o.value;var u=o.get;return void 0!==u?u.call(n):void 0}},function(e,t,r){e.exports={default:r(142),__esModule:!0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectType=t.ChangeType=void 0;var o=r(5),i=n(o),a=r(9),s=n(a);r(117);var u=r(30),c=function(){function e(t){(0,i.default)(this,e);var r=this;r._observers=[],r._filters={},this._data=t||{},this._internalObserve(this._data)}return(0,s.default)(e,[{key:"observe",value:function(e){this._observers.push(e)}},{key:"find",value:function(e){return this._findWithSplit((0,u.parseAttributes)(e))}},{key:"findBefore",value:function(e){var t={},r=(0,u.parseAttributes)(e);return t.last=r.pop(),t.obj=this._findWithSplit(r),t}},{key:"_findWithSplit",value:function(e){var t=this._data;return e.forEach(function(e){t=t[e]}),t}},{key:"_internalObserve",value:function(e){var t=this,r=function(e){e.every(function(e){t._onChanges(e)})};this._data=Object.deepObserve(e,r)}},{key:"_fireEvent",value:function(e){this._observers.forEach(function(t){t(e)})}},{key:"_onChanges",value:function(e){var t=e.object,r=void 0;t.constructor===Object&&(r=f.OBJECT),t.constructor===Array&&(r=f.ARRAY);var n=e.keypath,o=t[e.name];"update"!==e.type||n.includes(".length")||this._fireEvent({cType:l.UPDATE,oType:r,field:n,data:o}),"add"===e.type&&this._fireEvent({cType:l.ADD,oType:r,field:n,data:o}),"delete"===e.type&&this._fireEvent({cType:l.REMOVE,oType:r,field:n})}},{key:"data",get:function(){return this._data}}]),e}(),l=t.ChangeType={UPDATE:"update",ADD:"add",REMOVE:"remove"},f=t.ObjectType={OBJECT:"object",ARRAY:"array"};t.default=c},function(e,t){!function(){"use strict";function e(e,t,r,n,o,i){function a(e,n){if(a.delay=n,!a.pause&&u.changeset.length>0){if(!e){var o=u.changeset.filter(function(e){return!r||r.indexOf(e.type)>=0});o.length>0&&t(o)}u.changeset=[]}}var s,u=this;return a.pause=o,a.delay=i,u.get=function(e,t){return"__observer__"===t?u:"unobserve"===t?function(){return Object.unobserve(e),e}:"deliver"===t?a:e[t]},u.target=e,u.changeset=[],u.target.__observerCallbacks__||(Object.defineProperty(e,"__observerCallbacks__",{enumerable:!1,configurable:!0,writable:!1,value:[]}),Object.defineProperty(e,"__observers__",{enumerable:!1,configurable:!0,writable:!1,value:[]})),u.target.__observerCallbacks__.push(t),u.target.__observers__.push(this),s=new Proxy(e,u),a(!1,i),s}Object.observe||"function"!=typeof Proxy||(e.prototype.deliver=function(){return this.get(null,"deliver")},e.prototype.set=function(e,t,r){var n=e[t],o=void 0===n?"add":"update";if(e[t]=r,!(0>e.__observers__.indexOf(this)||this.acceptlist&&0>this.acceptlist.indexOf(o))){var i={object:e,name:t,type:o},a=0===this.changeset.length,s=this.deliver();"update"===o&&(i.oldValue=n),this.changeset.push(i),a&&s(!1,"number"==typeof s.delay?s.delay:10)}return!0},e.prototype.deleteProperty=function(e,t){var r=e[t];if(delete e[t],e.__observers__.indexOf(this)>=0&&!this.acceptlist||this.acceptlist.indexOf("delete")>=0){var n={object:e,name:t,type:"delete",oldValue:r},o=0===this.changeset.length,i=this.deliver();this.changeset.push(n),o&&i(!1,"number"==typeof i.delay?i.delay:10)}return!0},e.prototype.defineProperty=function(e,t,r){if(Object.defineProperty(e,t,r),e.__observers__.indexOf(this)>=0&&!this.acceptlist||this.acceptlist.indexOf("reconfigure")>=0){var n={object:e,name:t,type:"reconfigure"},o=0===this.changeset.length,i=this.deliver();this.changeset.push(n),o&&i(!1,"number"==typeof i.delay?i.delay:10)}return!0},e.prototype.setPrototypeOf=function(e,t){var r=Object.getPrototypeOf(e);if(Object.setPrototypeOf(e,t),e.__observers__.indexOf(this)>=0&&!this.acceptlist||this.acceptlist.indexOf("setPrototype")>=0){var n={object:e,name:"__proto__",type:"setPrototype",oldValue:r},o=0===this.changeset.length,i=this.deliver();this.changeset.push(n),o&&i(!1,"number"==typeof i.delay?i.delay:10)}return!0},e.prototype.preventExtensions=function(e){if(Object.preventExtensions(e),e.__observers__.indexOf(this)>=0&&!this.acceptlist||this.acceptlist.indexOf("preventExtensions")>=0){var t={object:e,type:"preventExtensions"},r=0===this.changeset.length,n=this.deliver();this.changeset.push(t),r&&n(!1,"number"==typeof n.delay?n.delay:10)}return!0},Object.observe=function(t,r,n,o,i,a){return new e(t,r,n,o,i,a)},Object.unobserve=function(e,t){if(e.__observerCallbacks__){if(!t)return e.__observerCallbacks__.splice(0,e.__observerCallbacks__.length),void e.__observers__.splice(0,e.__observers__.length);e.__observerCallbacks__.forEach(function(r,n){t===r&&(e.__observerCallbacks__.splice(n,1),delete e.__observers__[n].callback,e.__observers__.splice(n,1))})}},Array.observe=function(e,t,r,n,o,i){if(!(e instanceof Array||Array.isArray(e)))throw new TypeError("First argument to Array.observer is not an Array");r=r||["add","update","delete","splice"];var a=new Proxy(e,{get:function(t,n){return"unobserve"===n?function(e){return e?Object.unobserve(t,e):t.unobserve()}:"splice"===n?function(n,o){if("number"!=typeof n||"number"!=typeof o)throw new TypeError("First two arguments to Array splice are not number, number");var i=this.slice(n,n+o),a=arguments.length>1?arguments.length-2:0,u={object:e,type:"splice",index:n,removed:i,addedCount:a};if(t.splice.apply(t,arguments),r.indexOf("splice")>=0){var n=0===s.__observer__.changeset.length,c=s.__observer__.deliver();s.__observer__.changeset.push(u),n&&c(!1,"number"==typeof c.delay?c.delay:10)}}:"push"===n?function(e){return this.splice(this.length,0,e)}:"pop"===n?function(){return this.splice(this.length-1,1)}:"unshift"===n?function(e){return this.splice(0,0,e)}:"shift"===n?function(){return this.splice(0,1)}:t[n]}}),s=Object.observe(a,function(e){var n=e.filter(function(e){return!("length"===e.name||"add"===e.name||r&&0>r.indexOf(e.type))});n.length>0&&t(n)},r,n,o,i);return s},Array.unobserve=function(e,t){return e.unobserve(t)}),Object.deepObserve=function(e,t,r){function n(e,r){Object.keys(e).forEach(function(n){if(("object"===o(e[n])||"array"===o(e[n]))&&!e[n].hasOwnProperty("__observers__")){var i=r.slice(0);i.push(n),e[n]=Object.deepObserve(e[n],t,i)}})}r=r||[];var o=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()};return n(e,r),Object.observe(e,function(e){function o(e,t,r,n,a){if(n instanceof Object)Object.keys(n).forEach(function(s){if(!r||r[s]!==n[s]){var u=r&&void 0!==r[s]?r[s]:void 0,c=void 0===u?"add":"update",l=a+"."+s;i.push({name:e,object:t,type:c,oldValue:u,newValue:n[s],keypath:l}),o(e,t,u,n[s],l)}});else if(r instanceof Object){var s=Object.keys(r);s.forEach(function(s){var u=null===n?"update":"delete",c=a+"."+s;i.push({name:e,object:t,type:u,oldValue:r[s],newValue:n,keypath:c}),o(e,t,r[s],void 0,c)})}}var i=[];e.forEach(function(e){var t=(r.length>0?r.join(".")+".":"")+e.name;"update"!==e.type&&"add"!==e.type||n(e.object,r),i.push({name:e.name,object:e.object,type:e.type,oldValue:e.oldValue,newValue:e.object[e.name],keypath:t}),o(e.name,e.object,e.oldValue,e.object[e.name],t)}),t(i)})}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),i=n(o),a=r(5),s=n(a),u=r(9),c=n(u),l=r(25),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),d=r(116),p=n(d),h=r(30),v=f.getLogger("DataObjectChild");t.default=function(){function e(t){function r(e){throw"[DataObjectChild] "+e+" mandatory parameter is missing"}(0,s.default)(this,e);var n=this;t.parent?n._parent=t.parent:r("parent"),t.url?n._url=t.url:r("url"),t.created?n._created=t.created:r("created"),t.reporter?n._reporter=t.reporter:r("reporter"),t.runtime?n._runtime=t.runtime:r("runtime"),t.schema?n._schema=t.schema:r("schema"),t.parentObject?n._parentObject=t.parentObject:r("parentObject"),t.name&&(n._name=t.name),t.description&&(n._description=t.description),t.tags&&(n._tags=t.tags),t.resources&&(n._resources=t.resources),t.observerStorage&&(n._observerStorage=t.observerStorage),t.publicObservation&&(n._publicObservation=t.publicObservation),n._childId=t.url,n._syncObj=new p.default(t.data?t.data:{}),v.log("[DataObjectChild -  Constructor] - ",n._syncObj),n._bus=n._parentObject._bus,n._owner=n._parentObject._owner,n._allocateListeners(),n._metadata=t,delete n._metadata.parentObject,n._sharingStatus=!1}return(0,c.default)(e,[{key:"share",value:function(e){var t=this,r=void 0;r=e?t.metadata.parent:t.metadata.parent+"/children/"+t.metadata.children;var n=t.metadata;n.data=t.data;var o={type:"create",from:t.metadata.reporter,to:r,body:{resource:n.url,value:n}};t.identity&&(o.body.identity=t.identity),t._parentObject.data.hasOwnProperty("mutual")&&(o.body.mutual=t._parentObject.data.mutual),t._sharingStatus=new i.default(function(e,r){var n=t._bus.postMessage((0,h.deepClone)(o));if(t._parentObject.metadata.reporter===t.metadata.reporter)return e();t._bus.addResponseListener(o.from,n,function(i){if(i.to===t._reporter){t._bus.removeResponseListener(o.from,n),v.log("[Syncher.DataObjectChild.share] Parent reporter reply ",i);var a={code:i.body&&i.body.code?i.body.code:500,desc:i.body&&i.body.desc?i.body.desc:"Unknown"};return 300>i.body.code?e(a):r(a)}}),setTimeout(function(){return t._bus.removeResponseListener(o.from,n),r({code:408,desc:"timout"})},3e3)})}},{key:"store",value:function(){var e=this,t={},r=e.metadata.children+"."+e.metadata.url;t.value=e.metadata,t.identity=e.identity;var n={from:e.metadata.reporter,to:e._parentObject._syncher._subURL,type:"create",body:{resource:e.metadata.parent,attribute:r,value:t}};v.log("[DataObjectChild.store]:",n),e._bus.postMessage(n)}},{key:"delete",value:function(){return new i.default(function(e){v.log("[DataObjectChild.delete]"),e()})}},{key:"_allocateListeners",value:function(){var e=this;e._reporter===e._owner&&(e._listener=e._bus.addListener(e._reporter,function(t){"response"===t.type&&t.id===e._msgId&&(v.log("DataObjectChild.onResponse:",t),e._onResponse(t))}))}},{key:"_releaseListeners",value:function(){var e=this;e._listener&&e._listener.remove()}},{key:"delete",value:function(){this._releaseListeners()}},{key:"onChange",value:function(e){this._syncObj.observe(function(t){v.log("[DataObjectChild - observer] - ",t),e(t)})}},{key:"onResponse",value:function(e){this._onResponseHandler=e}},{key:"_onResponse",value:function(e){var t=this,r={type:e.type,url:e.body.source,code:e.body.code};t._onResponseHandler&&t._onResponseHandler(r)}},{key:"shareable",get:function(){var e=this.metadata;return e.data=this.data,e}},{key:"metadata",get:function(){return this._metadata}},{key:"childId",get:function(){return this._childId}},{key:"sharingStatus",get:function(){return this._sharingStatus}},{key:"data",get:function(){return this._syncObj.data}},{key:"identity",set:function(e){this._identity=e},get:function(){return this._identity}}]),e}(),e.exports=t.default},,function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),i=n(o),a=r(23),s=n(a),u=r(5),c=n(u),l=r(9),f=n(l),d=r(27),p=n(d),h=r(28),v=n(h),y=r(25),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(y),_=r(127),b=n(_),g=(r(30),r(128)),w=n(g),O=m.getLogger("FileHypertyResource");t.default=function(e){function t(e,r){(0,c.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e,r));return n.metadata.resourceType="file",n}return(0,v.default)(t,e),(0,f.default)(t,[{key:"init",value:function(e){var t=this;if(!e)throw Error("[FileHypertyResource.constructor] missing mandatory *file* input ");return new i.default(function(r,n){if(t._metadata.name=e.name,t._metadata.lastModified=e.lastModified,t._metadata.size=e.size,t._metadata.mimetype=e.type,O.log("[FileHypertyResource.init] file: ",e),t._isSender)switch(e.type.split("/")[0]){case"image":t._getImagePreview(e).then(function(n){t._metadata.preview=n,t._content=e,r()});break;default:t._content=e,r()}else t._content=e.content,e.preview&&(t._metadata.preview=e.preview),r()})}},{key:"_getImagePreview",value:function(e){var t=new FileReader;return new i.default(function(r,n){w.default.resize(e,{width:100,height:100},function(e,n){n?(t.readAsDataURL(e),t.onload=function(e){r(e.target.result)}):(O.warn("[FileHypertyResource._getImagePreview] unable to create image preview from original image "),r(void 0))})})}},{key:"toMessage",value:function(){}},{key:"name",get:function(){return this._metadata.name}},{key:"preview",get:function(){return this._metadata.preview}}]),t}(b.default),e.exports=t.default},,function(e,t,r){e.exports={default:r(123),__esModule:!0}},function(e,t,r){r(124);var n=r(0).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},function(e,t,r){var n=r(13),o=r(47).f;r(42)("getOwnPropertyDescriptor",function(){return function(e,t){return o(n(e),t)}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(50),i=n(o),a=r(29),s=n(a),u=r(61),c=n(u),l=r(115),f=n(l),d=r(5),p=n(d),h=r(9),v=n(h),y=r(25),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(y),_=r(116),b=n(_),g=r(118),w=n(g),O=r(30),j=r(126),x=n(j),k=m.getLogger("DataObject"),R=function(){function e(t){function r(e){throw"[DataObject] "+e+" mandatory parameter is missing"}(0,p.default)(this,e);var n=this;t.syncher?n._syncher=t.syncher:r("syncher"),t.url?n._url=t.url:r("url"),t.created?n._created=t.created:r("created"),t.reporter?n._reporter=t.reporter:r("reporter"),t.runtime?n._runtime=t.runtime:r("runtime"),t.schema?n._schema=t.schema:r("schema"),t.name?n._name=t.name:r("name"),n._status=t.status,n._syncObj=new b.default(t.data?t.data:{}),n._childrens=t.childrens,n._mutual=t.mutual,n._version=0,n._childId=0,n._childrenListeners=[],n._resumed=t.resume,t.resume&&(n._version=t.version),n._owner=t.syncher._owner,n._bus=t.syncher._bus,t.description&&(n._description=t.description),t.tags&&(n._tags=t.tags),t.resources&&(n._resources=t.resources),t.observerStorage&&(n._observerStorage=t.observerStorage),t.publicObservation&&(n._publicObservation=t.publicObservation),n._metadata=(0,f.default)(t),n._metadata.lastModified=n._metadata.created,delete n._metadata.data,delete n._metadata.syncher,delete n._metadata.authorise,n._hypertyResourceFactory=new x.default,n._childrenObjects={},n._sharedChilds=[]}return(0,v.default)(e,[{key:"_getLastChildId",value:function(){var e=this,t=0,r=e._owner+"#"+t;return(0,c.default)(e._childrens).filter(function(t){e._childrens[t].childId>r&&(r=e._childrens[t].childId)}),t=+r.split("#")[1]}},{key:"_allocateListeners",value:function(){var e=this,t=this,r=t._url+"/children/";k.log("[Data Object - AllocateListeners] - ",t._childrens),t._childrens&&t._childrens.forEach(function(n){var o=r+n,i=t._bus.addListener(o,function(r){if(r.from!==e._owner)switch(k.log("DataObject-Children-RCV: ",r),r.type){case"create":t._onChildCreate(r);break;case"delete":k.log(r);break;default:t._changeChildren(r)}});t._childrenListeners.push(i)})}},{key:"_releaseListeners",value:function(){var e=this;e._childrenListeners.forEach(function(e){e.remove()}),(0,c.default)(e._childrenObjects).forEach(function(t){(0,c.default)(e._childrenObjects[t]).forEach(function(r){e._childrenObjects[t][r]._releaseListeners()})})}},{key:"resumeChildrens",value:function(e){var t=this,r=this,n=this._owner+"#"+this._childId;(0,c.default)(e).forEach(function(o){var i=e[o];(0,c.default)(i).forEach(function(e){var a=!1;r._childrenObjects.hasOwnProperty(o)||(r._childrenObjects[o]={}),i[e].value.resourceType&&!r._childrenObjects[o].hasOwnProperty(e)?(r._childrenObjects[o][e]=r._resumeHypertyResource(i[e]),a=!0):r._childrenObjects[o].hasOwnProperty(e)||(r._childrenObjects[o][e]=r._resumeChild(i[e]),k.log("[DataObject.resumeChildrens] new DataObjectChild: ",r._childrenObjects[o][e]),a=!0),a&&e>n&&(n=e,k.log("[DataObjectReporter.resumeChildrens] - resuming: ",t._childrenObjects[o][e]))})}),this._childId=+n.split("#")[1]}},{key:"_resumeChild",value:function(e){var t=this,r=e.value;r.parentObject=t,r.parent=t._url;var n=new w.default(r);n.identity=e.identity;var o={type:"create",from:n.reporter,url:n.parent,value:n.data,childId:n.url,identity:n.identity,child:n};return n.resourceType&&(o.resource=n),t._onAddChildrenHandler&&t._onAddChildrenHandler(o),n}},{key:"_resumeHypertyResource",value:function(e){var t=this,r=e.value;r.parentObject=t,r.parent=t._url;var n=t._hypertyResourceFactory.createHypertyResource(!1,r.resourceType,r);n.identity=e.identity;var o={type:"create",from:n.reporter,url:n.parent,value:n.data,childId:n.url,identity:n.identity,child:n};return n.resourceType&&(o.resource=n),t._onAddChildrenHandler&&t._onAddChildrenHandler(o),n}},{key:"pause",value:function(){throw"Not implemented"}},{key:"resume",value:function(){throw"Not implemented"}},{key:"stop",value:function(){throw"Not implemented"}},{key:"addChild",value:function(e,t,r,n){var o=this,i=void 0;return new s.default(function(a){var s=o._url+"/children/"+e,u=o._getChildInput(n);u.data=t,u.children=e,i=new w.default(u),r&&(i.identity=r),i.share(),k.log("[DataObject.addChild] added ",i),i.onChange(function(e){o._onChange(e,{path:s,childId:u.url})}),o._childrenObjects.hasOwnProperty(e)||(o._childrenObjects[e]={}),o._childrenObjects[e][u.url]=i,a(i)})}},{key:"_deleteChildrens",value:function(){var e=this,t=[];return new s.default(function(r){if(e.childrens){k.log("[DataObject.deleteChildrens]",e.childrens);var n=void 0;for(n in e.childrens){var o=void 0;for(o in e.childrens[n]){var i=e.childrens[n][o];k.log("[DataObject._deleteChildrens] child",i),i.metadata.hasOwnProperty("resourceType")&&t.push(e.childrens[n][o].delete())}}}k.log("[DataObject._deleteChildrens] promises ",t),t.length>0?s.default.all(t).then(function(){r("[DataObject._deleteChildrens] done")}):r("[DataObject._deleteChildrens] nothing to delete")})}},{key:"_getChildInput",value:function(e){var t=this,r=(0,f.default)({},e);return t._childId++,r.url=t._owner+"#"+t._childId,r.parentObject=t,r.reporter=t._owner,r.created=(new Date).toISOString(),r.runtime=t._syncher._runtimeUrl,r.p2pHandler=t._syncher._p2pHandler,r.p2pRequester=t._syncher._p2pRequester,r.schema=t._schema,r.parent=t.url,r}},{key:"addHypertyResource",value:function(e,t,r,n,o){var i=this;return new s.default(function(a){var s=void 0,u=i._url+"/children/"+e,c=i._getChildInput(o);c.children=e,i._hypertyResourceFactory.createHypertyResourceWithContent(!0,t,r,c).then(function(t){s=t,n&&(s.identity=n),s.share(),k.log("[DataObject.addHypertyResource] added ",s),s.onChange(function(e){i._onChange(e,{path:u,childId:s.childId})}),i._childrenObjects.hasOwnProperty(e)||(i._childrenObjects[e]={}),i._childrenObjects[e][s.childId]=s,a(s)})})}},{key:"onAddChild",value:function(e){this._onAddChildrenHandler=e}},{key:"_onChildCreate",value:function(e){var t=this;k.log("[DataObject._onChildCreate] receivedBy "+t._owner+" : ",e),t._bus.postMessage({from:e.to,to:e.from,type:"response",id:e.id,body:{code:100}}),e.body.value.resourceType?t._onHypertyResourceAdded(e):t._onChildAdded(e)}},{key:"_onChildAdded",value:function(e){var t=this,r=(0,O.deepClone)(e.body.value);r.parentObject=t;var n=r.children,o=new w.default(r);o.identity=e.body.identity,t._childrenObjects.hasOwnProperty(n)||(t._childrenObjects[n]={}),t._childrenObjects[n][r.url]=o,e.to===t.metadata.url&&o.store(),t._hypertyEvt(e,o)}},{key:"_onHypertyResourceAdded",value:function(e){var t=this,r=e.body.value,n=void 0,o=r.children;r.parentObject=t,n=t._hypertyResourceFactory.createHypertyResource(!1,r.resourceType,r),n.identity=e.body.identity,t._childrenObjects.hasOwnProperty(o)||(t._childrenObjects[o]={}),t._childrenObjects[o][n.childId]=n,t._hypertyEvt(e,n),e.to===t.metadata.url&&n.store()}},{key:"_hypertyEvt",value:function(e,t){var r=this,n={type:e.type,from:e.from,url:e.to,value:t.data,childId:t.url,identity:e.body.identity,child:t};t.resourceType&&(n.resource=t),r._onAddChildrenHandler&&r._onAddChildrenHandler(n)}},{key:"_onChange",value:function(e,t){var r=this;if(r._metadata.lastModified=(new Date).toISOString(),r._version++,"live"===r._status){var n={type:"update",from:r._url,to:r._url+"/changes",body:{version:r._version,source:r._owner,attribute:e.field,lastModified:r._metadata.lastModified}};k.log("[DataObject - _onChange] - ",e,t,n),e.oType===_.ObjectType.OBJECT?e.cType!==_.ChangeType.REMOVE&&(n.body.value=(0,O.deepClone)(e.data)):(n.body.attributeType=e.oType,n.body.value=e.data,e.cType!==_.ChangeType.UPDATE&&(n.body.operation=e.cType)),t&&(n.to=t.path,n.body.resource=t.childId),r.data._mutual||(n.body.mutual=r._mutual),r._bus.postMessage(n)}}},{key:"_changeObject",value:function(e,t){var r=this;if(t.body.version<r._version+1)k.log("UNSYNCHRONIZED VERSION: (data => "+r._version+", msg => "+t.body.version+")");else{r._version=t.body.version;var n=t.body.attribute,o=void 0;o="object"===(0,i.default)(t.body.value)?(0,O.deepClone)(t.body.value):t.body.value;var a=e.findBefore(n);if(r._metadata.lastModified=t.body.lastModified?t.body.lastModified:(new Date).toISOString(),t.body.attributeType===_.ObjectType.ARRAY)if(t.body.operation===_.ChangeType.ADD){var s=a.obj,u=a.last;Array.prototype.splice.apply(s,[u,0].concat(o))}else if(t.body.operation===_.ChangeType.REMOVE){var c=a.obj,l=a.last;c.splice(l,o)}else a.obj[a.last]=o;else t.body.hasOwnProperty("value")?a.obj[a.last]=o:delete a.obj[a.last]}}},{key:"_changeChildren",value:function(e){var t=this,r=(0,O.divideURL)(e.to),n=r.identity,o=n?n.substring(n.lastIndexOf("/")+1):void 0,i=e.body.resource,a=t._childrenObjects[o][i];k.log("Change children: ",t._owner,e,o),a?t._changeObject(a._syncObj,e):k.warn("No children found for: ",i)}},{key:"metadata",get:function(){return this._metadata}},{key:"url",get:function(){return this._url}},{key:"schema",get:function(){return this._schema}},{key:"status",get:function(){return this._status}},{key:"data",get:function(){return this._syncObj.data}},{key:"childrens",get:function(){return this._childrenObjects}}]),e}();t.default=R,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),i=n(o),a=r(5),s=n(a),u=r(9),c=n(u),l=r(120),f=n(l);t.default=function(){function e(){(0,s.default)(this,e)}return(0,c.default)(e,[{key:"createHypertyResource",value:function(e,t,r){var n=void 0;switch(t){case"file":n=new f.default(e,r);break;default:throw Error("[HypertyResourceFactory.createHypertyResource] not supported type: ",t)}return n}},{key:"createHypertyResourceWithContent",value:function(e,t,r,n){var o=void 0;return new i.default(function(i){switch(t){case"file":o=new f.default(e,n);break;default:reject()}o.init(r).then(function(){return o.save()}).then(function(){i(o)})})}}]),e}(),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),i=n(o),a=r(23),s=n(a),u=r(5),c=n(u),l=r(9),f=n(l),d=r(27),p=n(d),h=r(114),v=n(h),y=r(28),m=n(y),_=r(25),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(_),g=r(30),w=r(118),O=n(w),j=b.getLogger("HypertyResource");t.default=function(e){function t(e,r){(0,c.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,s.default)(t)).call(this,r)),o=n;return o.arraybufferSizeLimit=5242880,o._isSender=e,o._localStorageURL=o._parentObject._syncher._runtimeUrl+"/storage",n}return(0,m.default)(t,e),(0,f.default)(t,[{key:"save",value:function(){var e=this;return new i.default(function(t,r){var n={from:e._owner,to:e._localStorageURL,type:"create",body:{value:(0,g.deepClone)(e._metadata)}};n.body.value.content=e._content;var o=e._bus.postMessage(n);e._bus.addResponseListener(e._owner,o,function(n){j.info("[HypertyResource.save] reply: ",n),e._bus.removeResponseListener(e._owner,o),200===n.body.code?(n.body.value&&(e._metadata.contentURL||(e._metadata.contentURL=[]),e._metadata.contentURL.push(n.body.value)),t()):r(n.body.code+" "+n.body.desc)})})}},{key:"read",value:function(e){var t=this;return j.info("[HypertyResource.read] ",this),new i.default(function(r,n){if(t.content)r(t);else{var o=t._getBestContentURL(t._metadata.contentURL);j.log("Storage:",o);var i={from:t._owner,to:o.url,type:"read",body:{resource:o.url+"/"+o.resource,p2p:!0}};t.metadata.p2pRequester&&t.metadata.p2pHandler&&(i.body.p2pRequester=t.metadata.p2pRequester,i.body.p2pHandler=t.metadata.p2pHandler),t._getBestResource(i,e).then(function(e){j.info("[HypertyResource] - get locally the resource:",e),r(t)}).catch(function(i){j.warn("[HypertyResource] - get locally the resource fail",i);var a={from:t._owner,to:o.remoteURL,type:"read",body:{resource:o.remoteURL+"/"+o.resource,p2p:!0}};t.metadata.p2pRequester&&t.metadata.p2pHandler&&(a.body.p2pRequester=t.metadata.p2pRequester,a.body.p2pHandler=t.metadata.p2pHandler),t._getBestResource(a,e).then(function(e){j.warn("[HypertyResource] - get remotely the resource",e),r(t)}).catch(function(e){j.warn("[HypertyResource] - get remotely the resource fail",e),n(e.body.code+" "+e.body.desc)})})}})}},{key:"_getBestResource",value:function(e,t){var r=this;return new i.default(function(n,o){var i=r._bus.postMessage(e),a=setTimeout(function(){return r._bus.removeResponseListener(r._owner,i),e.body.code=408,e.body.desc="Response timeout",o(e)},3e3);r._bus.addResponseListener(r._owner,i,function(e){switch(j.log("[HypertyResource.read] reply: ",e),clearTimeout(a),e.body.code){case 200:r._content=e.body.value.content,r.arraybufferSizeLimit>e.body.value.size&&r.save(),r._bus.removeResponseListener(r._owner,i),n(e);break;case 183:t(e.body.value);break;default:r._bus.removeResponseListener(r._owner,i),o(e)}})})}},{key:"delete",value:function(){var e=this;j.info("[HypertyResource.delete]",e.metadata);var t={from:e._owner,to:e._localStorageURL,type:"delete",body:{resources:e.metadata.contentURL}};return new i.default(function(r){e._bus.postMessage(t,function(e){r(300>e.body.code)})})}},{key:"_getBestContentURL",value:function(e){var t=this,r=e[0];return{url:t._localStorageURL,resource:r.substr(r.lastIndexOf("/")+1),remoteURL:r.substr(0,r.lastIndexOf("/"))}}},{key:"resourceType",get:function(){return this.metadata.resourceType}},{key:"mimetype",get:function(){return this._metadata.type}},{key:"content",get:function(){return this._content}},{key:"contentURL",get:function(){return this._metadata.contentURL}},{key:"shareable",get:function(){var e=this,r=(0,v.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"metadata",this);return r.resourceType=e.resourceType,r}}]),t}(O.default),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),i=n(o),a=r(9),s=n(a),u="undefined"!=typeof Blob&&function(){try{return!!new Blob}catch(e){return!1}}(),c=u&&"undefined"!=typeof Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),l="undefined"!=typeof HTMLCanvasElement&&HTMLCanvasElement.prototype.toBlob,f=l||"undefined"!=typeof Uint8Array&&"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof atob,d="undefined"!=typeof FileReader||"undefined"!=typeof URL,p=function(){function e(){(0,i.default)(this,e)}return(0,s.default)(e,null,[{key:"resize",value:function(t,r,n){if("function"==typeof r&&(n=r,r={width:640,height:480}),!e.isSupported()||!t.type.match(/image.*/))return n(t,!1),!1;if(t.type.match(/image\/gif/))return n(t,!1),!1;var o=document.createElement("img");return o.onload=function(i){var a=o.width,s=o.height,u=!1;if(a>=s&&a>r.width?(s*=r.width/a,a=r.width,u=!0):s>r.height&&(a*=r.height/s,s=r.height,u=!0),!u)return void n(t,!1);var c=document.createElement("canvas");if(c.width=a,c.height=s,c.getContext("2d").drawImage(o,0,0,a,s),l)c.toBlob(function(e){n(e,!0)},t.type);else{var f=e._toBlob(c,t.type);n(f,!0)}},e._loadImage(o,t),!0}},{key:"_toBlob",value:function(e,t){var r=e.toDataURL(t),n=r.split(","),o=void 0;o=0>n[0].indexOf("base64")?decodeURIComponent(n[1]):atob(n[1]);for(var i=new ArrayBuffer(o.length),a=new Uint8Array(i),s=0;o.length>s;s+=1)a[s]=o.charCodeAt(s);var l=n[0].split(":")[1].split(";")[0],f=null;if(u)f=new Blob([c?a:i],{type:l});else{var d=new BlobBuilder;d.append(i),f=d.getBlob(l)}return f}},{key:"_loadImage",value:function(e,t,r){if("undefined"==typeof URL){var n=new FileReader;n.onload=function(t){e.src=t.target.result,r&&r()},n.readAsDataURL(t)}else e.src=URL.createObjectURL(t),r&&r()}},{key:"isSupported",value:function(){return"undefined"!=typeof HTMLCanvasElement&&f&&d}}]),e}();t.default=p,e.exports=t.default},,,,,function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(61),i=n(o),a=r(56),s=n(a),u=r(29),c=n(u),l=r(23),f=n(l),d=r(5),p=n(d),h=r(9),v=n(h),y=r(27),m=n(y),_=r(114),b=n(_),g=r(28),w=n(g),O=r(25),j=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(O),x=r(125),k=n(x),R=r(30),P=j.getLogger("DataObjectReporter");t.default=function(e){function t(e){(0,p.default)(this,t);var r=(0,m.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e)),n=r;return n._subscriptions={},n._syncObj.observe(function(e){P.log("[Syncher.DataObjectReporter] "+n.url+" publish change: ",e),n._onChange(e)}),n._allocateListeners(),n._invitations=[],n.invitations=[],n._childrenSizeThreshold=5e4,r}return(0,w.default)(t,e),(0,v.default)(t,[{key:"_allocateListeners",value:function(){(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"_allocateListeners",this).call(this);var e=this;e._objectListener=e._bus.addListener(e._url,function(t){switch(P.log("[Syncher.DataObjectReporter] listener "+e._url+" Received: ",t),t.type){case"response":e._onResponse(t);break;case"read":e._onRead(t);break;case"execute":e._onExecute(t);break;case"create":e._onChildCreate(t)}})}},{key:"_releaseListeners",value:function(){(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"_releaseListeners",this).call(this),this._objectListener.remove()}},{key:"inviteObservers",value:function(e,t){var r=this,n=e;n.length>0&&(P.log("[Syncher.DataObjectReporter] InviteObservers ",n,r._metadata),n.forEach(function(e){var n=new c.default(function(n,o){var i={type:"create",from:r._syncher._owner,to:r._syncher._subURL,body:{resume:!1,resource:r._url,schema:r._schema,value:r._metadata,authorise:[e]}};t&&(i.body.p2p=t),r.data.mutual||(i.body.mutual=r.data.mutual),r._bus.postMessage(i,function(t){P.log("[Syncher.DataObjectReporter] Invitation reply ",t);var r={invited:e,code:t.body&&t.body.code?t.body.code:500,desc:t.body&&t.body.desc?t.body.desc:"Unknown"};300>r.code?n(r):r.code>=300&&o(r)})});r.invitations.push(n)}))}},{key:"delete",value:function(){var e=this;e._deleteChildrens().then(function(t){P.log(t),e._bus.postMessage({type:"delete",from:e._owner,to:e._syncher._subURL,body:{resource:e._url}},function(t){P.log("DataObjectReporter-DELETE: ",t),200===t.body.code&&(e._releaseListeners(),delete e._syncher._reporters[e._url],e._syncObj={})})})}},{key:"onSubscription",value:function(e){this._onSubscriptionHandler=e}},{key:"onResponse",value:function(e){this._onResponseHandler=e}},{key:"onRead",value:function(e){this._onReadHandler=e}},{key:"onExecute",value:function(e){this._onExecuteHandler=e}},{key:"_onForward",value:function(e){var t=this;switch(P.log("DataObjectReporter-RCV: ",e),e.body.type){case"subscribe":t._onSubscribe(e);break;case"unsubscribe":t._onUnSubscribe(e)}}},{key:"_onSubscribe",value:function(e){var t=this,r=e.body.from,n=(0,R.divideURL)(r),o=n.domain,i=!0;e.body.hasOwnProperty("mutual")&&!e.body.mutual&&(i=!1),P.log("[DataObjectReporter._onSubscribe]",e,o,n);var a={type:e.body.type,url:r,domain:o,identity:e.body.identity,nutual:i,accept:function(){var n={url:r,status:"live"};t._subscriptions[r]=n,t.metadata.subscriptions&&t.metadata.subscriptions.push(n.url);var o=(0,R.deepClone)(t._metadata);o.data=(0,R.deepClone)(t.data),o.version=t._version;var i={id:e.id,type:"response",from:e.to,to:e.from,body:{code:200,schema:t._schema,value:o}};return e.body.hasOwnProperty("mutual")&&!e.body.mutual&&(i.body.mutual=e.body.mutual,t.data.mutual=!1),t._bus.postMessage(i),n},reject:function(r){t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:403,desc:r}})}};t._onSubscriptionHandler&&(P.log("SUBSCRIPTION-EVENT: ",a),t._onSubscriptionHandler(a))}},{key:"_onUnSubscribe",value:function(e){var t=this,r=e.body.from,n=(0,R.divideURL)(r),o=n.domain;P.log("[DataObjectReporter._onUnSubscribe]",e,o,n),delete t._subscriptions[r],delete t._invitations[r];var i={type:e.body.type,url:r,domain:o,identity:e.body.identity};t._onSubscriptionHandler&&(P.log("UN-SUBSCRIPTION-EVENT: ",i),t._onSubscriptionHandler(i))}},{key:"_onResponse",value:function(e){var t=this,r={type:e.type,url:e.from,code:e.body.code};t._onResponseHandler&&(P.log("RESPONSE-EVENT: ",r),t._onResponseHandler(r))}},{key:"_onRead",value:function(e){var t=this,r=(0,s.default)(t.childrensJSON).length,n=r>t._childrenSizeThreshold,o={type:e.type,url:e.from,accept:function(){n?t._syncReplyForLargeData(e):t._syncReply(e)},reject:function(r){t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:401,desc:r}})}},a=[];t.metadata.subscriptions?a=t.metadata.subscriptions:t._subscriptions&&(a=(0,i.default)(t._subscriptions).map(function(e){return t._subscriptions[e].url})),-1!=a.indexOf(e.from)?n?t._syncReplyForLargeData(e):t._syncReply(e):t._onReadHandler&&(P.log("READ-EVENT: ",o),t._onReadHandler(o))}},{key:"_syncReply",value:function(e){var t=this,r=(0,R.deepClone)(t.metadata);r.data=(0,R.deepClone)(t.data),r.childrenObjects=t.childrensJSON,r.version=t._version,t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:200,value:r}})}},{key:"_syncReplyForLargeData",value:function(e){var t=this,r=(0,R.deepClone)(t.metadata);r.data=(0,R.deepClone)(t.data),r.version=t._version,delete r.childrenObjects;var n=void 0,o=[],i={};for(n in t._childrenObjects){var a=void 0;i[n]={};for(a in t._childrenObjects[n])(0,s.default)(i).length>t._childrenSizeThreshold&&(o.push(i),i={},i[n]={}),i[n][a]={},i[n][a].value=t._childrenObjects[n][a].metadata,i[n][a].identity=t._childrenObjects[n][a].identity}o.push(i),r.responses=o.length+1;var u={id:e.id,type:"response",from:e.to,to:e.from,body:{code:100,value:r}};t._bus.postMessage(u),o.forEach(function(e){var n=(0,R.deepClone)(u);n.body.value=e,n.body.value.responses=r.responses,setTimeout(function(){t._bus.postMessage(n)},50)})}},{key:"_onExecute",value:function(e){var t=this;if(!e.body.method)throw e;var r={id:e.id,type:"response",from:e.to,to:e.from,body:{code:200}},n={type:e.type,url:e.from,method:e.body.method,params:e.body.params,accept:function(){t._bus.postMessage(r)},reject:function(r){t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:401,desc:r}})}};t._onExecuteHandler&&(P.log("[DataObjectReporter] EXECUTE-EVENT: ",n),t._onExecuteHandler(n))}},{key:"subscriptions",get:function(){return this._subscriptions}},{key:"childrensJSON",get:function(){var e=this,t={},r=void 0;for(r in e._childrenObjects){var n=void 0;t[r]={};for(n in e._childrenObjects[r])t[r][n]={},t[r][n].value=e._childrenObjects[r][n].metadata,t[r][n].identity=e._childrenObjects[r][n].identity}return t}}]),t}(k.default),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(61),i=n(o),a=r(115),s=n(a),u=r(29),c=n(u),l=r(23),f=n(l),d=r(5),p=n(d),h=r(9),v=n(h),y=r(27),m=n(y),_=r(114),b=n(_),g=r(28),w=n(g),O=r(25),j=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(O),x=r(30),k=r(125),R=n(k),P=j.getLogger("DataObjectObserver");t.default=function(e){function t(e){(0,p.default)(this,t);var r=(0,m.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e)),n=r;return n._version=e.version,n._filters={},n._syncObj.observe(function(e){n._onFilter(e)}),n._allocateListeners(),r}return(0,w.default)(t,e),(0,v.default)(t,[{key:"sync",value:function(){var e=this;return P.info("[DataObjectObserver_sync] synchronising "),new c.default(function(t,r){e._syncher.read(e._metadata.url).then(function(r){P.info("[DataObjectObserver_sync] value to sync: ",r),(0,s.default)(e.data,(0,x.deepClone)(r.data)),e._version=r.version,e._metadata.lastModified=r.lastModified,r.childrenObjects?(e.resumeChildrens(r.childrenObjects),e._storeChildrens(),t(!0)):t(!0)}).catch(function(e){P.info("[DataObjectObserver_sync] sync failed: ",e),t(!1)})})}},{key:"_storeChildrens",value:function(){var e=this,t={};(0,i.default)(e._childrenObjects).forEach(function(r){var n=e._childrenObjects[r];t[r]={},(0,i.default)(n).forEach(function(e){t[r][e]={},t[r][e].value=n[e].metadata,t[r][e].identity=n[e].identity})}),e._bus.postMessage({from:e._owner,to:e._syncher._subURL,type:"create",body:{resource:e._url,attribute:"childrenObjects",value:t}})}},{key:"_allocateListeners",value:function(){(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"_allocateListeners",this).call(this);var e=this;e._changeListener=e._bus.addListener(e._url+"/changes",function(t){"update"===t.type&&(P.log("DataObjectObserver-"+e._url+"-RCV: ",t),e._changeObject(e._syncObj,t))})}},{key:"_releaseListeners",value:function(){(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"_releaseListeners",this).call(this),this._changeListener.remove()}},{key:"delete",value:function(){var e=this;e._deleteChildrens().then(function(){e.unsubscribe(),e._releaseListeners(),delete e._syncher._observers[e._url]})}},{key:"unsubscribe",value:function(){var e=this;e._bus.postMessage({type:"unsubscribe",from:e._owner,to:e._syncher._subURL,body:{resource:e._url}},function(t){P.log("DataObjectObserver-UNSUBSCRIBE: ",t),200===t.body.code&&(e._releaseListeners(),delete e._syncher._observers[e._url])})}},{key:"onChange",value:function(e,t){var r=e,n={type:"exact",callback:t},o=e.indexOf("*");o===e.length-1&&(0===o?n.type="any":(n.type="start",r=e.substr(0,e.length-1))),this._filters[r]=n}},{key:"_onFilter",value:function(e){var t=this;(0,i.default)(t._filters).forEach(function(r){var n=t._filters[r];"any"===n.type?n.callback(e):"start"===n.type?0===e.field.indexOf(r)&&n.callback(e):"exact"===n.type&&e.field===r&&n.callback(e)})}},{key:"onDisconnected",value:function(e){var t=this;return new c.default(function(r,n){t._subscribeRegistration().then(function(){t._onDisconnected=e,r()}).catch(function(e){return n(e)})})}},{key:"_subscribeRegistration",value:function(){var e=this,t={type:"subscribe",from:this._owner,to:this._syncher._runtimeUrl+"/subscriptions",body:{resources:[this._url+"/registration"]}};return new c.default(function(r,n){e._bus.postMessage(t,function(t){P.log("[DataObjectObserver._subscribeRegistration] "+e._url+" rcved reply ",t),200===t.body.code?(e._generateListener(e._url+"/registration"),r()):(P.error("Error subscribing registration status for ",e._url),n("Error subscribing registration status for "+e._url))})})}},{key:"_generateListener",value:function(e){var t=this;t._bus.addListener(e,function(e){P.log("[DataObjectObserver.registrationNotification] "+t._url+": ",e),e.body.value&&"disconnected"===e.body.value&&t._onDisconnected&&(P.log("[DataObjectObserver] "+t._url+": was disconnected ",e),t._onDisconnected())})}},{key:"execute",value:function(e,t){var r=this,n=this;return new c.default(function(o,i){n._bus.postMessage({type:"execute",from:r._owner,to:n._url,body:{method:e,params:t}},function(t){P.log("[DataObjectObserver.execute] "+n._url+" rcved reply ",t),200===t.body.code?o():(P.warn("[DataObjectObserver.execute] execution of method "+e+" was reject by reporter"),i("[DataObjectObserver.execute] execution of method "+e+" was reject by reporter"))})})}}]),t}(R.default),e.exports=t.default},,,,,,,function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(29),i=n(o),a=r(115),s=n(a),u=r(5),c=n(u),l=r(9),f=n(l),d=r(25),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),h=r(30),v=r(133),y=n(v),m=r(134),_=n(m),b=r(145),g=n(b),w=p.getLogger("Syncher");t.default=function(){function e(t,r,n){(0,c.default)(this,e);var o=this;o._owner=t,o._bus=r,o._subURL=n.runtimeURL+"/sm",o._runtimeUrl=n.runtimeURL,o._p2pHandler=n.p2pHandler,o._p2pRequester=n.p2pRequester,o._reporters={},o._observers={},o._provisionals={},r.addListener(t,function(e){if(e.from!==t)switch(w.info("[Syncher] Syncher-RCV: ",e,o),e.type){case"forward":o._onForward(e);break;case"create":o._onRemoteCreate(e);break;case"delete":o._onRemoteDelete(e);break;case"execute":o._onExecute(e)}})}return(0,f.default)(e,[{key:"create",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"no name",a=arguments[6],u=arguments[7];if(!e)throw Error("[Syncher - Create] - You need specify the data object schema");if(!t)throw Error("[Syncher - Create] -The observers should be defined");var c=this,l=(0,s.default)({},u);return l.p2p=o,l.store=n,l.schema=e,l.authorise=t,l.p2pHandler=c._p2pHandler,l.p2pRequester=c._p2pRequester,l.data=r?(0,h.deepClone)(r):{},l.name=0===i.length?"no name":i,l.reporter=c._owner,l.resume=!1,u?(l.mutual=!u.hasOwnProperty("mutual")||u.mutual,l.name=u.hasOwnProperty("name")?u.name:l.name):l.mutual=!0,a&&(l.identity=a),w.log("[syncher - create] - create Reporter - createInput: ",l),c._create(l)}},{key:"resumeReporters",value:function(e){var t=this;return w.log("[syncher - create] - resume Reporter - criteria: ",e),(0,s.default)(e,{resume:!0}),t._resumeCreate(e)}},{key:"subscribe",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments[5],a=this,u={};return u.p2p=n,u.store=r,u.schema=e,u.resource=t,i&&(u.identity=i),u.mutual=o,w.log("[syncher - subscribe] - subscribe criteria: ",u),(0,s.default)(u,{resume:!1}),a._subscribe(u)}},{key:"resumeObservers",value:function(e){var t=this,r=e||{};return(0,s.default)(r,{resume:!0}),t._resumeSubscribe(r)}},{key:"read",value:function(e){var t=this,r={type:"read",from:t._owner,to:e};return new i.default(function(e,n){var o=t._bus.postMessage(r),i={},a={},u=0;t._bus.addResponseListener(r.from,o,function(c){if(w.log("[Syncher.read] reply: ",c),300>c.body.code)if(c.body.value.hasOwnProperty("responses"))if(0===u)a=c.body.value,++u;else{delete c.body.value.responses;var l=void 0;for(l in c.body.value)i.hasOwnProperty(l)||(i[l]={}),(0,s.default)(i[l],c.body.value[l]);++u===a.responses&&(a.childrenObjects=i,delete a.responses,t._bus.removeResponseListener(r.from,o),e(a))}else t._bus.removeResponseListener(r.from,o),e(c.body.value);else n(c.body.desc)})})}},{key:"onNotification",value:function(e){this._onNotificationHandler=e}},{key:"onClose",value:function(e){this._onClose=e}},{key:"_create",value:function(e){var t=this;return new i.default(function(r,n){var o=(0,s.default)({},e),i=e.resume;o.created=(new Date).toISOString(),o.runtime=t._runtimeUrl;var a=(0,h.deepClone)(o);delete a.p2p,delete a.store,delete a.observers,delete a.identity;var u={type:"create",from:t._owner,to:t._subURL,body:{resume:i,value:a}};u.body.schema=o.schema,o.p2p&&(u.body.p2p=o.p2p),o.store&&(u.body.store=o.store),o.identity&&(u.body.identity=o.identity),w.log("[syncher._create]: ",o,u),t._bus.postMessage(u,function(i){if(w.log("[syncher - create] - create-response: ",i),200===i.body.code){o.url=i.body.resource,o.status="live",o.syncher=t,o.childrens=i.body.childrenResources;var a=t._reporters[o.url];a||(a=new y.default(o),t._reporters[o.url]=a),a.inviteObservers(e.authorise,e.p2p),r(a)}else n(i.body.desc)})})}},{key:"_resumeCreate",value:function(e){var t=this,r=this;return new i.default(function(n,o){var i=e.resume,a={type:"create",from:r._owner,to:r._subURL,body:{resume:i}};w.log("[syncher - create]: ",e,a),e&&(a.body.value=e,a.body.value.reporter=r._owner),e.p2p&&(a.body.p2p=e.p2p),e.store&&(a.body.store=e.store),e.observers&&(a.body.authorise=e.observers),e.identity&&(a.body.identity=e.identity),w.log("[syncher._resumeCreate] - resume message: ",a),r._bus.postMessage(a,function(e){if(w.log("[syncher._resumeCreate] - create-resumed-response: ",e),200===e.body.code){var i=e.body.value;for(var a in i){var s=i[a];s.data=(0,h.deepClone)(s.data)||{},s.childrenObjects&&(s.childrenObjects=(0,h.deepClone)(s.childrenObjects)),s.mutual=!1,s.resume=!0,s.status="live",s.syncher=r,w.log("[syncher._resumeCreate] - create-resumed-dataObjectReporter",s);var u=new y.default(s);s.childrenObjects&&u.resumeChildrens(s.childrenObjects),r._reporters[s.url]=u}n(r._reporters),t._onReportersResume&&t._onReportersResume(t._reporters)}else 404===e.body.code?n({}):o(e.body.desc)})})}},{key:"_subscribe",value:function(e){var t=this;return new i.default(function(r,n){var o={type:"subscribe",from:t._owner,to:t._subURL,body:{}};e&&(e.hasOwnProperty("p2p")&&(o.body.p2p=e.p2p),e.hasOwnProperty("store")&&(o.body.store=e.store),e.hasOwnProperty("schema")&&(o.body.schema=e.schema),e.hasOwnProperty("identity")&&(o.body.identity=e.identity),e.hasOwnProperty("resource")&&(o.body.resource=e.resource)),o.body.resume=e.resume,e.hasOwnProperty("mutual")&&(o.body.mutual=e.mutual),w.log("[syncher_subscribe] - subscribe message: ",e,o),t._bus.postMessage(o,function(o){w.log("[syncher] - subscribe-response: ",o);var i=o.body.resource,a=t._provisionals[i];if(delete t._provisionals[i],a&&a._releaseListeners(),200>o.body.code)w.log("[syncher] - new DataProvisional: ",o.body.childrenResources,i),a=new g.default(t._owner,i,t._bus,o.body.childrenResources),t._provisionals[i]=a;else if(200===o.body.code){w.log("[syncher] - new Data Object Observer: ",o,t._provisionals);var s=o.body.value;s.syncher=t,s.p2p=e.p2p,s.store=e.store,s.identity=e.identity,s.resume=!1,s.mutual=e.mutual;var u=t._observers[i];u?u.sync():(u=new _.default(s),t._observers[i]=u),w.log("[syncher] - new Data Object Observer already exist: ",u),r(u),a&&a.apply(u)}else n(o.body.desc)})})}},{key:"_resumeSubscribe",value:function(e){var t=this,r=this;return new i.default(function(n,o){var i={type:"subscribe",from:r._owner,to:r._subURL,body:{}};e&&(e.hasOwnProperty("p2p")&&(i.body.p2p=e.p2p),e.hasOwnProperty("store")&&(i.body.store=e.store),e.hasOwnProperty("schema")&&(i.body.schema=e.schema),e.hasOwnProperty("identity")&&(i.body.identity=e.identity),e.hasOwnProperty("resource")&&(i.body.resource=e.url)),i.body.resume=e.resume;var a=e.mutual;e.hasOwnProperty("mutual")&&(i.body.mutual=a),w.log("[syncher] - subscribe message: ",e,i),r._bus.postMessage(i,function(e){w.log("[syncher] - subscribe-resumed-response: ",e);var i=e.body.resource,a=r._provisionals[i];if(delete r._provisionals[i],a&&a._releaseListeners(),200>e.body.code)w.log("[syncher] - resume new DataProvisional: ",e,i),a=new g.default(r._owner,i,r._bus,e.body.childrenResources),r._provisionals[i]=a;else if(200===e.body.code){var s=e.body.value;for(var u in s){var c=s[u];w.log("[syncher] - Resume Object Observer: ",e,c,r._provisionals),c.childrenObjects&&(c.childrenObjects=(0,h.deepClone)(c.childrenObjects)),c.data=(0,h.deepClone)(c.data)||{},c.resume=!0,c.syncher=r,w.log("[syncher._resumeSubscribe] - create new dataObject: ",c);var l=new _.default(c);c.childrenObjects&&l.resumeChildrens(c.childrenObjects),w.log("[syncher._resumeSubscribe] - new dataObject",l),r._observers[l.url]=l,r._provisionals[l.url]&&r._provisionals[l.url].apply(l)}n(r._observers),t._onObserversResume&&t._onObserversResume(r._observers)}else 404===e.body.code?n({}):o(e.body.desc)})})}},{key:"_onForward",value:function(e){this._reporters[e.body.to]._onForward(e)}},{key:"_onRemoteCreate",value:function(e){var t=this,r=e.from.slice(0,-13),n=(0,h.divideURL)(r),o=n.domain,i={type:e.type,from:e.body.source,url:r,domain:o,schema:e.body.schema,value:e.body.value,identity:e.body.identity,ack:function(r){var n=200;r&&(n=r),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:n}})}};t._onNotificationHandler&&(w.info("[Syncher] NOTIFICATION-EVENT: ",i),t._onNotificationHandler(i))}},{key:"_onRemoteDelete",value:function(e){var t=this,r=e.body.resource,n=t._observers[r];if(t._bus.postMessage({from:t.owner,to:t._subURL,id:e.id,type:"unsubscribe",body:{resource:e.body.resource}}),delete t._observers[r],n){var o={type:e.type,url:r,identity:e.body.identity,ack:function(r){var o=200;r&&(o=r),200===o&&n.delete(),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:o,source:t._owner}})}};t._onNotificationHandler&&(w.log("NOTIFICATION-EVENT: ",o),t._onNotificationHandler(o))}else t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:404,source:t._owner}})}},{key:"_onExecute",value:function(e){var t=this,r={id:e.id,type:"response",from:e.to,to:e.from,body:{code:200}};if((e.from===t._runtimeUrl+"/registry/"||e.from===t._runtimeUrl+"/registry")&&e.body&&e.body.method&&"close"===e.body.method&&t._onClose){var n={type:"close",ack:function(e){e&&(r.body.code=e),t._bus.postMessage(r)}};w.info("[Syncher] Close-EVENT: ",n),t._onClose(n)}else t._bus.postMessage(r)}},{key:"onReportersResume",value:function(e){this._onReportersResume=e}},{key:"onObserversResume",value:function(e){this._onObserversResume=e}},{key:"owner",get:function(){return this._owner}},{key:"reporters",get:function(){return this._reporters}},{key:"observers",get:function(){return this._observers}}]),e}(),e.exports=t.default},function(e,t,r){r(143),e.exports=r(0).Object.assign},function(e,t,r){var n=r(4);n(n.S+n.F,"Object",{assign:r(144)})},function(e,t,r){"use strict";var n=r(22),o=r(55),i=r(39),a=r(35),s=r(63),u=Object.assign;e.exports=!u||r(12)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n})?function(e,t){for(var r=a(e),u=arguments.length,c=1,l=o.f,f=i.f;u>c;)for(var d,p=s(arguments[c++]),h=l?n(p).concat(l(p)):n(p),v=h.length,y=0;v>y;)f.call(p,d=h[y++])&&(r[d]=p[d]);return r}:u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),i=n(o),a=r(9),s=n(a),u=r(25),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(u),l=c.getLogger("DataProvisional");t.default=function(){function e(t,r,n,o){(0,i.default)(this,e);var a=this;a._owner=t,a._url=r,a._bus=n,a._children=o,a._changes=[],a._allocateListeners()}return(0,s.default)(e,[{key:"_allocateListeners",value:function(){var e=this;e._listener=e._bus.addListener(e._url,function(t){l.log("DataProvisional-"+e._url+"-RCV: ",t),e._changes.push(t)})}},{key:"_releaseListeners",value:function(){this._listener.remove()}},{key:"apply",value:function(e){this._changes.forEach(function(t){e._changeObject(e._syncObj,t)})}},{key:"children",get:function(){return this._children}}]),e}(),e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DataObjectObserver=t.DataObjectReporter=t.Syncher=void 0;var o=r(25),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),a=r(141),s=n(a),u=r(133),c=n(u),l=r(134),f=n(l),d=i.getLogger("Syncher"),p=i.getLogger("DataObject"),h=i.getLogger("DataObjectChild"),v=i.getLogger("DataObjectObserver"),y=i.getLogger("DataObjectReporter"),m=i.getLogger("DataProvisional");d.setLevel(3),p.setLevel(3),h.setLevel(3),v.setLevel(3),y.setLevel(3),m.setLevel(3),t.Syncher=s.default,t.DataObjectReporter=c.default,t.DataObjectObserver=f.default}])})},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.default=function(){function e(){n(this,e),this.__eventListeners={}}return o(e,[{key:"addEventListener",value:function(e,t){void 0!=t&&(this.__eventListeners[e]?this.__eventListeners[e].push(t):this.__eventListeners[e]=[t])}},{key:"trigger",value:function(e,t){var r=this.__eventListeners[e];r&&r.forEach(function(r){try{r(t)}catch(n){console.warn("calling listener "+r.name+" for event type "+e+" with parameters '"+t+"' resulted in an error!",n)}})}}]),e}()},function(e,t,r){"use strict";function n(e){function t(e){return e.replace(/([a-zA-Z-]*)(:\/\/(?:\.)?|:)([-a-zA-Z0-9@:%._\+~#=]{2,256})([-a-zA-Z0-9@:%._\+~#=\/]*)/gi,"$1,$3,$4").split(",")}if(!e)throw Error("URL is needed to split");var r=t(e);if(r[0]===e&&!r[0].includes("@")){var n={type:"",domain:e,identity:""};return console.error("[DivideURL] DivideURL don't support url without scheme. Please review your url address",e),n}if(r[0]===e&&r[0].includes("@")){r=t((r[0]===e?"smtp":r[0])+"://"+r[0])}return r[1].includes("@")&&(r[2]=r[0]+"://"+r[1],r[1]=r[1].substr(r[1].indexOf("@")+1)),{type:r[0],domain:r[1],identity:r[2]}}function o(e){if(e)return JSON.parse(JSON.stringify(e))}function i(e){return new Promise(function(t,r){navigator.mediaDevices.getUserMedia(e).then(function(e){t(e)}).catch(function(e){r(e)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.divideURL=n,t.deepClone=o,t.getUserMedia=i},function(e,t,r){var n,o,i;!function(a,s){"use strict";"object"==typeof e&&e.exports?e.exports=s(r(0),r(1),r(2)):(o=[r(0),r(1),r(2)],n=s,void 0!==(i="function"==typeof n?n.apply(t,o):n)&&(e.exports=i))}(0,function(e,t,r,n){"use strict";function o(e,t){var r=arguments.length>=1,n=arguments.length>=2;if(!(this instanceof o))return r?n?new o(e,t):new o(e):new o;if(void 0===e){if(r)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&r)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}function i(e){return/^[0-9]+$/.test(e)}function a(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function s(e){return void 0===e?"Undefined":(Object.prototype.toString.call(e)+"").slice(8,-1)}function u(e){return"Array"===s(e)}function c(e,t){var r,n,o={};if("RegExp"===s(t))o=null;else if(u(t))for(r=0,n=t.length;n>r;r++)o[t[r]]=!0;else o[t]=!0;for(r=0,n=e.length;n>r;r++){(o&&void 0!==o[e[r]]||!o&&t.test(e[r]))&&(e.splice(r,1),n--,r--)}return e}function l(e,t){var r,n;if(u(t)){for(r=0,n=t.length;n>r;r++)if(!l(e,t[r]))return!1;return!0}var o=s(t);for(r=0,n=e.length;n>r;r++)if("RegExp"===o){if("string"==typeof e[r]&&e[r].match(t))return!0}else if(e[r]===t)return!0;return!1}function f(e,t){if(!u(e)||!u(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var r=0,n=e.length;n>r;r++)if(e[r]!==t[r])return!1;return!0}function d(e){return e.replace(/^\/+|\/+$/g,"")}function p(e){return escape(e)}function h(e){return encodeURIComponent(e).replace(/[!'()*]/g,p).replace(/\*/g,"%2A")}function v(e){return function(t,r){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!r),this)}}function y(e,t){return function(r,n){return void 0===r?this._parts[e]||"":(null!==r&&(r+="",r.charAt(0)===t&&(r=r.substring(1))),this._parts[e]=r,this.build(!n),this)}}var m=n&&n.URI;o.version="1.19.0";var _=o.prototype,b=Object.prototype.hasOwnProperty;o._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:o.preventInvalidHostname,duplicateQueryParameters:o.duplicateQueryParameters,escapeQuerySpace:o.escapeQuerySpace}},o.preventInvalidHostname=!1,o.duplicateQueryParameters=!1,o.escapeQuerySpace=!0,o.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,o.idn_expression=/[^a-z0-9\._-]/i,o.punycode_expression=/(xn--)/i,o.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,o.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,o.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},o.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},o.hostProtocols=["http","https"],o.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,o.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},o.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return o.domAttributes[t]}},o.encode=h,o.decode=decodeURIComponent,o.iso8859=function(){o.encode=escape,o.decode=unescape},o.unicode=function(){o.encode=h,o.decode=decodeURIComponent},o.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},o.encodeQuery=function(e,t){var r=o.encode(e+"");return void 0===t&&(t=o.escapeQuerySpace),t?r.replace(/%20/g,"+"):r},o.decodeQuery=function(e,t){e+="",void 0===t&&(t=o.escapeQuerySpace);try{return o.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var g,w={encode:"encode",decode:"decode"},O=function(e,t){return function(r){try{return o[t](r+"").replace(o.characters[e][t].expression,function(r){return o.characters[e][t].map[r]})}catch(e){return r}}};for(g in w)o[g+"PathSegment"]=O("pathname",w[g]),o[g+"UrnPathSegment"]=O("urnpath",w[g]);var j=function(e,t,r){return function(n){var i;i=r?function(e){return o[t](o[r](e))}:o[t];for(var a=(n+"").split(e),s=0,u=a.length;u>s;s++)a[s]=i(a[s]);return a.join(e)}};o.decodePath=j("/","decodePathSegment"),o.decodeUrnPath=j(":","decodeUrnPathSegment"),o.recodePath=j("/","encodePathSegment","decode"),o.recodeUrnPath=j(":","encodeUrnPathSegment","decode"),o.encodeReserved=O("reserved","encode"),o.parse=function(e,t){var r;return t||(t={preventInvalidHostname:o.preventInvalidHostname}),r=e.indexOf("#"),r>-1&&(t.fragment=e.substring(r+1)||null,e=e.substring(0,r)),r=e.indexOf("?"),r>-1&&(t.query=e.substring(r+1)||null,e=e.substring(0,r)),"//"===e.substring(0,2)?(t.protocol=null,e=e.substring(2),e=o.parseAuthority(e,t)):(r=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,r)||null,t.protocol&&!t.protocol.match(o.protocol_expression)?t.protocol=void 0:"//"===e.substring(r+1,r+3)?(e=e.substring(r+3),e=o.parseAuthority(e,t)):(e=e.substring(r+1),t.urn=!0)),t.path=e,t},o.parseHost=function(e,t){e||(e=""),e=e.replace(/\\/g,"/");var r,n,i=e.indexOf("/");if(-1===i&&(i=e.length),"["===e.charAt(0))r=e.indexOf("]"),t.hostname=e.substring(1,r)||null,"/"===(t.port=e.substring(r+2,i)||null)&&(t.port=null);else{var a=e.indexOf(":"),s=e.indexOf("/"),u=e.indexOf(":",a+1);-1===u||-1!==s&&u>=s?(n=e.substring(0,i).split(":"),t.hostname=n[0]||null,t.port=n[1]||null):(t.hostname=e.substring(0,i)||null,t.port=null)}return t.hostname&&"/"!==e.substring(i).charAt(0)&&(i++,e="/"+e),t.preventInvalidHostname&&o.ensureValidHostname(t.hostname,t.protocol),t.port&&o.ensureValidPort(t.port),e.substring(i)||"/"},o.parseAuthority=function(e,t){return e=o.parseUserinfo(e,t),o.parseHost(e,t)},o.parseUserinfo=function(e,t){var r,n=e.indexOf("/"),i=e.lastIndexOf("@",n>-1?n:e.length-1);return i>-1&&(-1===n||n>i)?(r=e.substring(0,i).split(":"),t.username=r[0]?o.decode(r[0]):null,r.shift(),t.password=r[0]?o.decode(r.join(":")):null,e=e.substring(i+1)):(t.username=null,t.password=null),e},o.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var r,n,i,a={},s=e.split("&"),u=s.length,c=0;u>c;c++)r=s[c].split("="),n=o.decodeQuery(r.shift(),t),i=r.length?o.decodeQuery(r.join("="),t):null,b.call(a,n)?("string"!=typeof a[n]&&null!==a[n]||(a[n]=[a[n]]),a[n].push(i)):a[n]=i;return a},o.build=function(e){var t="";return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//"),t+=o.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&"string"==typeof e.hostname&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},o.buildHost=function(e){var t="";return e.hostname?(o.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},o.buildAuthority=function(e){return o.buildUserinfo(e)+o.buildHost(e)},o.buildUserinfo=function(e){var t="";return e.username&&(t+=o.encode(e.username)),e.password&&(t+=":"+o.encode(e.password)),t&&(t+="@"),t},o.buildQuery=function(e,t,r){var n,i,a,s,c="";for(i in e)if(b.call(e,i)&&i)if(u(e[i]))for(n={},a=0,s=e[i].length;s>a;a++)void 0!==e[i][a]&&void 0===n[e[i][a]+""]&&(c+="&"+o.buildQueryParameter(i,e[i][a],r),!0!==t&&(n[e[i][a]+""]=!0));else void 0!==e[i]&&(c+="&"+o.buildQueryParameter(i,e[i],r));return c.substring(1)},o.buildQueryParameter=function(e,t,r){return o.encodeQuery(e,r)+(null!==t?"="+o.encodeQuery(t,r):"")},o.addQuery=function(e,t,r){if("object"==typeof t)for(var n in t)b.call(t,n)&&o.addQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=r);"string"==typeof e[t]&&(e[t]=[e[t]]),u(r)||(r=[r]),e[t]=(e[t]||[]).concat(r)}},o.setQuery=function(e,t,r){if("object"==typeof t)for(var n in t)b.call(t,n)&&o.setQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===r?null:r}},o.removeQuery=function(e,t,r){var n,i,a;if(u(t))for(n=0,i=t.length;i>n;n++)e[t[n]]=void 0;else if("RegExp"===s(t))for(a in e)t.test(a)&&(e[a]=void 0);else if("object"==typeof t)for(a in t)b.call(t,a)&&o.removeQuery(e,a,t[a]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==r?"RegExp"===s(r)?e[t]=!u(e[t])&&r.test(e[t])?void 0:c(e[t],r):e[t]!==r+""||u(r)&&1!==r.length?u(e[t])&&(e[t]=c(e[t],r)):e[t]=void 0:e[t]=void 0}},o.hasQuery=function(e,t,r,n){switch(s(t)){case"String":break;case"RegExp":for(var i in e)if(b.call(e,i)&&t.test(i)&&(void 0===r||o.hasQuery(e,i,r)))return!0;return!1;case"Object":for(var a in t)if(b.call(t,a)&&!o.hasQuery(e,a,t[a]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(s(r)){case"Undefined":return t in e;case"Boolean":return r===!!(u(e[t])?e[t].length:e[t]);case"Function":return!!r(e[t],t,e);case"Array":if(!u(e[t]))return!1;return(n?l:f)(e[t],r);case"RegExp":return u(e[t])?!!n&&l(e[t],r):!(!e[t]||!e[t].match(r));case"Number":r+="";case"String":return u(e[t])?!!n&&l(e[t],r):e[t]===r;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},o.joinPaths=function(){for(var e=[],t=[],r=0,n=0;arguments.length>n;n++){var i=new o(arguments[n]);e.push(i);for(var a=i.segment(),s=0;a.length>s;s++)"string"==typeof a[s]&&t.push(a[s]),a[s]&&r++}if(!t.length||!r)return new o("");var u=new o("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||u.path("/"+u.path()),u.normalize()},o.commonPath=function(e,t){var r,n=Math.min(e.length,t.length);for(r=0;n>r;r++)if(e.charAt(r)!==t.charAt(r)){r--;break}return 1>r?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(r)&&"/"===t.charAt(r)||(r=e.substring(0,r).lastIndexOf("/")),e.substring(0,r+1))},o.withinString=function(e,t,r){r||(r={});var n=r.start||o.findUri.start,i=r.end||o.findUri.end,a=r.trim||o.findUri.trim,s=r.parens||o.findUri.parens,u=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var c=n.exec(e);if(!c)break;var l=c.index;if(r.ignoreHtml){var f=e.slice(Math.max(l-3,0),l);if(f&&u.test(f))continue}for(var d=l+e.slice(l).search(i),p=e.slice(l,d),h=-1;;){var v=s.exec(p);if(!v)break;var y=v.index+v[0].length;h=Math.max(h,y)}if(p=h>-1?p.slice(0,h)+p.slice(h).replace(a,""):p.replace(a,""),p.length>c[0].length&&(!r.ignore||!r.ignore.test(p))){d=l+p.length;var m=t(p,l,d,e);void 0!==m?(m+="",e=e.slice(0,l)+m+e.slice(d),n.lastIndex=l+m.length):n.lastIndex=d}}return n.lastIndex=0,e},o.ensureValidHostname=function(t,r){var n=!!t,i=!!r,a=!1;if(i&&(a=l(o.hostProtocols,r)),a&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+r);if(t&&t.match(o.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(o.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},o.ensureValidPort=function(e){if(e){var t=+e;if(!(i(t)&&t>0&&65536>t))throw new TypeError('Port "'+e+'" is not a valid port')}},o.noConflict=function(e){if(e){var t={URI:this.noConflict()};return n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t}return n.URI===this&&(n.URI=m),this},_.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=o.build(this._parts),this._deferred_build=!1),this},_.clone=function(){return new o(this)},_.valueOf=_.toString=function(){return this.build(!1)._string},_.protocol=v("protocol"),_.username=v("username"),_.password=v("password"),_.hostname=v("hostname"),_.port=v("port"),_.query=y("query","?"),_.fragment=y("fragment","#"),_.search=function(e,t){var r=this.query(e,t);return"string"==typeof r&&r.length?"?"+r:r},_.hash=function(e,t){var r=this.fragment(e,t);return"string"==typeof r&&r.length?"#"+r:r},_.pathname=function(e,t){if(void 0===e||!0===e){var r=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?o.decodeUrnPath:o.decodePath)(r):r}return this._parts.path=this._parts.urn?e?o.recodeUrnPath(e):"":e?o.recodePath(e):"/",this.build(!t),this},_.path=_.pathname,_.href=function(e,t){var r;if(void 0===e)return""+this;this._string="",this._parts=o._parts();var n=e instanceof o,i="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName){e=e[o.getDomAttribute(e)]||"",i=!1}if(!n&&i&&void 0!==e.pathname&&(e=""+e),"string"==typeof e||e instanceof String)this._parts=o.parse(e+"",this._parts);else{if(!n&&!i)throw new TypeError("invalid input");var a=n?e._parts:e;for(r in a)b.call(this._parts,r)&&(this._parts[r]=a[r])}return this.build(!t),this},_.is=function(e){var t=!1,n=!1,i=!1,a=!1,s=!1,u=!1,c=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,n=o.ip4_expression.test(this._parts.hostname),i=o.ip6_expression.test(this._parts.hostname),t=n||i,a=!t,s=a&&r&&r.has(this._parts.hostname),u=a&&o.idn_expression.test(this._parts.hostname),c=a&&o.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return a;case"sld":return s;case"ip":return t;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return i;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var x=_.protocol,k=_.port,R=_.hostname;_.protocol=function(e,t){if(e&&(e=e.replace(/:(\/\/)?$/,""),!e.match(o.protocol_expression)))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return x.call(this,e,t)},_.scheme=_.protocol,_.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(e+="",":"===e.charAt(0)&&(e=e.substring(1)),o.ensureValidPort(e))),k.call(this,e,t))},_.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var r={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==o.parseHost(e,r))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=r.hostname,this._parts.preventInvalidHostname&&o.ensureValidHostname(e,this._parts.protocol)}return R.call(this,e,t)},_.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var r=this.protocol();return this.authority()?(r?r+"://":"")+this.authority():""}var n=o(e);return this.protocol(n.protocol()).authority(n.authority()).build(!t),this},_.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildHost(this._parts):"";if("/"!==o.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},_.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildAuthority(this._parts):"";if("/"!==o.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},_.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var r=o.buildUserinfo(this._parts);return r?r.substring(0,r.length-1):r}return"@"!==e[e.length-1]&&(e+="@"),o.parseUserinfo(e,this._parts),this.build(!t),this},_.resource=function(e,t){var r;return void 0===e?this.path()+this.search()+this.hash():(r=o.parse(e),this._parts.path=r.path,this._parts.query=r.query,this._parts.fragment=r.fragment,this.build(!t),this)},_.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";return this._parts.hostname.substring(0,this._parts.hostname.length-this.domain().length-1)||""}var r=this._parts.hostname.length-this.domain().length,n=this._parts.hostname.substring(0,r),i=RegExp("^"+a(n));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&o.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(i,e),this.build(!t),this},_.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.match(/\./g);if(r&&2>r.length)return this._parts.hostname;var n=this._parts.hostname.length-this.tld(t).length-1;return n=this._parts.hostname.lastIndexOf(".",n-1)+1,this._parts.hostname.substring(n)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(o.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{this._parts.hostname=this._parts.hostname.replace(RegExp(a(this.domain())+"$"),e)}return this.build(!t),this},_.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),o=this._parts.hostname.substring(n+1);return!0!==t&&r&&r.list[o.toLowerCase()]?r.get(this._parts.hostname)||o:o}var i;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!r||!r.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');i=RegExp(a(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");i=RegExp(a(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}return this.build(!t),this},_.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var r=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,r)||(this._parts.hostname?"/":"");return e?o.decodePath(n):n}var i=this._parts.path.length-this.filename().length,s=this._parts.path.substring(0,i),u=RegExp("^"+a(s));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=o.recodePath(e),this._parts.path=this._parts.path.replace(u,e),this.build(!t),this},_.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var r=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(r+1);return e?o.decodePathSegment(n):n}var i=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(i=!0);var s=RegExp(a(this.filename())+"$");return e=o.recodePath(e),this._parts.path=this._parts.path.replace(s,e),i?this.normalizePath(t):this.build(!t),this},_.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var r,n,i=this.filename(),s=i.lastIndexOf(".");return-1===s?"":(r=i.substring(s+1),n=/^[a-z0-9%]+$/i.test(r)?r:"",e?o.decodePathSegment(n):n)}"."===e.charAt(0)&&(e=e.substring(1));var u,c=this.suffix();if(c)u=e?RegExp(a(c)+"$"):RegExp(a("."+c)+"$");else{if(!e)return this;this._parts.path+="."+o.recodePath(e)}return u&&(e=o.recodePath(e),this._parts.path=this._parts.path.replace(u,e)),this.build(!t),this},_.segment=function(e,t,r){var n=this._parts.urn?":":"/",o=this.path(),i="/"===o.substring(0,1),a=o.split(n);if(void 0!==e&&"number"!=typeof e&&(r=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw Error('Bad segment "'+e+'", must be 0-based integer');if(i&&a.shift(),0>e&&(e=Math.max(a.length+e,0)),void 0===t)return void 0===e?a:a[e];if(null===e||void 0===a[e])if(u(t)){a=[];for(var s=0,c=t.length;c>s;s++)(t[s].length||a.length&&a[a.length-1].length)&&(a.length&&!a[a.length-1].length&&a.pop(),a.push(d(t[s])))}else(t||"string"==typeof t)&&(t=d(t),""===a[a.length-1]?a[a.length-1]=t:a.push(t));else t?a[e]=d(t):a.splice(e,1);return i&&a.unshift(""),this.path(a.join(n),r)},_.segmentCoded=function(e,t,r){var n,i,a;if("number"!=typeof e&&(r=t,t=e,e=void 0),void 0===t){if(n=this.segment(e,t,r),u(n))for(i=0,a=n.length;a>i;i++)n[i]=o.decode(n[i]);else n=void 0!==n?o.decode(n):void 0;return n}if(u(t))for(i=0,a=t.length;a>i;i++)t[i]=o.encode(t[i]);else t="string"==typeof t||t instanceof String?o.encode(t):t;return this.segment(e,t,r)};var P=_.query;return _.query=function(e,t){if(!0===e)return o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var r=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return this._parts.query=o.buildQuery(e.call(this,r)||r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=o.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):P.call(this,e,t)},_.setQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)n[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var i in e)b.call(e,i)&&(n[i]=e[i])}return this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(r=t),this.build(!r),this},_.addQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.addQuery(n,e,void 0===t?null:t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(r=t),this.build(!r),this},_.removeQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.removeQuery(n,e,t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(r=t),this.build(!r),this},_.hasQuery=function(e,t,r){return o.hasQuery(o.parseQuery(this._parts.query,this._parts.escapeQuerySpace),e,t,r)},_.setSearch=_.setQuery,_.addSearch=_.addQuery,_.removeSearch=_.removeQuery,_.hasSearch=_.hasQuery,_.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},_.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},_.normalizeHostname=function(r){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!r)),this},_.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===o.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},_.normalizePath=function(e){var t=this._parts.path;if(!t)return this;if(this._parts.urn)return this._parts.path=o.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;t=o.recodePath(t);var r,n,i,a="";for("/"!==t.charAt(0)&&(r=!0,t="/"+t),"/.."!==t.slice(-3)&&"/."!==t.slice(-2)||(t+="/"),t=t.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),r&&(a=t.substring(1).match(/^(\.\.\/)+/)||"")&&(a=a[0]);;){if(-1===(n=t.search(/\/\.\.(\/|$)/)))break;0!==n?(i=t.substring(0,n).lastIndexOf("/"),-1===i&&(i=n),t=t.substring(0,i)+t.substring(n+3)):t=t.substring(3)}return r&&this.is("relative")&&(t=a+t.substring(1)),this._parts.path=t,this.build(!e),this},_.normalizePathname=_.normalizePath,_.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(o.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},_.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},_.normalizeSearch=_.normalizeQuery,_.normalizeHash=_.normalizeFragment,_.iso8859=function(){var e=o.encode,t=o.decode;o.encode=escape,o.decode=decodeURIComponent;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},_.unicode=function(){var e=o.encode,t=o.decode;o.encode=h,o.decode=unescape;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},_.readable=function(){var t=this.clone();t.username("").password("").normalize();var r="";if(t._parts.protocol&&(r+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(r+=e.toUnicode(t._parts.hostname),t._parts.port&&(r+=":"+t._parts.port)):r+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(r+="/"),r+=t.path(!0),t._parts.query){for(var n="",i=0,a=t._parts.query.split("&"),s=a.length;s>i;i++){var u=(a[i]||"").split("=");n+="&"+o.decodeQuery(u[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==u[1]&&(n+="="+o.decodeQuery(u[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}r+="?"+n.substring(1)}return r+=o.decodeQuery(t.hash(),!0)},_.absoluteTo=function(e){var t,r,n,i=this.clone(),a=["protocol","username","password","hostname","port"];if(this._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");if(e instanceof o||(e=new o(e)),i._parts.protocol)return i;if(i._parts.protocol=e._parts.protocol,this._parts.hostname)return i;for(r=0;n=a[r];r++)i._parts[n]=e._parts[n];return i._parts.path?(".."===i._parts.path.substring(-2)&&(i._parts.path+="/"),"/"!==i.path().charAt(0)&&(t=e.directory(),t=t||(0===e.path().indexOf("/")?"/":""),i._parts.path=(t?t+"/":"")+i._parts.path,i.normalizePath())):(i._parts.path=e._parts.path,i._parts.query||(i._parts.query=e._parts.query)),i.build(),i},_.relativeTo=function(e){var t,r,n,i,a,s=this.clone().normalize();if(s._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");if(e=new o(e).normalize(),t=s._parts,r=e._parts,i=s.path(),a=e.path(),"/"!==i.charAt(0))throw Error("URI is already relative");if("/"!==a.charAt(0))throw Error("Cannot calculate a URI relative to another relative URI");return t.protocol===r.protocol&&(t.protocol=null),t.username!==r.username||t.password!==r.password?s.build():null!==t.protocol||null!==t.username||null!==t.password?s.build():t.hostname!==r.hostname||t.port!==r.port?s.build():(t.hostname=null,t.port=null,i===a?(t.path="",s.build()):(n=o.commonPath(i,a))?(t.path=r.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../")+t.path.substring(n.length)||"./",s.build()):s.build())},_.equals=function(e){var t,r,n,i=this.clone(),a=new o(e),s={},c={},l={};if(i.normalize(),a.normalize(),""+i==""+a)return!0;if(t=i.query(),r=a.query(),i.query(""),a.query(""),""+i!=""+a)return!1;if(t.length!==r.length)return!1;s=o.parseQuery(t,this._parts.escapeQuerySpace),c=o.parseQuery(r,this._parts.escapeQuerySpace);for(n in s)if(b.call(s,n)){if(u(s[n])){if(!f(s[n],c[n]))return!1}else if(s[n]!==c[n])return!1;l[n]=!0}for(n in c)if(b.call(c,n)&&!l[n])return!1;return!0},_.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},_.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},_.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},o})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Object.assign({},{id:"_"+Math.random().toString(36).substr(2,9),values:[{name:"availability",type:"availability_status",unit:"pres",value:"available"}]})}}]).default});